<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extended Hanson-Koopmans • cmstatr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Extended Hanson-Koopmans">
<meta property="og:description" content="cmstatr">
<meta property="og:image" content="https://www.cmstatr.net/reference/figures/logo-240x278.png">
<meta property="og:image:alt" content="Statistical methods for composite material data: cmstatr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmstatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adktest.html">Anderson-Darling k-Sample Test</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Graphing.html">Plotting Composite Material Data</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Tutorial.html">cmstatr Tutorial</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Validation.html">cmstatr Validation</a>
    </li>
    <li>
      <a href="../articles/hk_ext.html">Extended Hanson-Koopmans</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cmstatr/cmstatr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Extended Hanson-Koopmans</h1>
                        <h4 data-toc-skip class="author">Stefan
Kloppenborg</h4>
            
            <h4 data-toc-skip class="date">2021-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cmstatr/cmstatr/blob/HEAD/vignettes/hk_ext.Rmd" class="external-link"><code>vignettes/hk_ext.Rmd</code></a></small>
      <div class="hidden name"><code>hk_ext.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we’ll use the following packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<p>The Extended Hanson–Koopmans method is a nonparametric method of
determining tolerance limits (such as A- or B-Basis values). This method
does not assume any particular distribution, but does require that <span class="math inline">\(-\log\left(F\right)\)</span> is convex, where
<span class="math inline">\(F\)</span> is the cumulative distribution
function (CDF) of the distribution.</p>
<p>The functions <code>kh_ext_z</code>, <code>hk_ext_z_j_opt</code> and
<code>basis_kh_ext</code> in <code>cmstatr</code> are based on the
Extended Hanson–Koopmans method, developed by Vangel <span class="citation">[1]</span>. This is an extension of the method
published in <span class="citation">[2]</span>.</p>
<p>Tolerance limits (Basis values) calculated using the Extended
Hanson–Koopmans method are calculated based on two order statistics <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, and a factor, <span class="math inline">\(z\)</span>. The function
<code>hk_ext_z_j_opt</code> and the function <code>basis_kh_ext</code>
(with <code>method = "optimum-order"</code>) set the first of these
order statistics to the first (lowest) order statistic, and a second
order statistic determined by minimizing the following function:</p>
<p><span class="math display">\[
\left| z E\left(X_{\left(1\right)}\right)
+ \left(1 - z\right) E\left(X_{\left(j\right)}\right)
- \Phi\left(p\right)\right|
\]</span></p>
<p>Where <span class="math inline">\(E\left(X_{(i)}\right)\)</span> is
the expected value of the <span class="math inline">\(i\)</span><code>th</code> order statistic for a
sample drawn from the standard normal distribution, and <span class="math inline">\(\Phi\left(p\right)\)</span> is the CDF of a
standard normal distribution for the content of the tolerance limit
(i.e. <span class="math inline">\(p=0.9\)</span> for B-Basis).</p>
<p>The value of <span class="math inline">\(z\)</span> is calculated
based on the sample size, <span class="math inline">\(n\)</span>, the
two order statistics <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, the content <span class="math inline">\(p\)</span> and the confidence. The calculation is
performed using the method in <span class="citation">[1]</span> and
implemented in <code>kh_ext_z</code>. The value of <span class="math inline">\(j\)</span> is very sensitive to the way that the
expected value of the order statistics is calculated, and may be
sensitive to numerical precision.</p>
<p>In version 0.8.0 of <code>cmstatr</code> and prior, the expected
value of an order statistic for a sample drawn from a standard normal
distribution was determined in a crude way. After version 0.8.0, the
method in <span class="citation">[3]</span> is used. These method
produce different values of <span class="math inline">\(j\)</span> for
certain sample sizes. Additionally, a table of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> values for various sample sizes is
published in CMH-17-1G<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> <span class="citation">[4]</span>. This
table gives slightly different values of <span class="math inline">\(j\)</span> for some sample sizes.</p>
<p>The values of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> produced by <code>cmstatr</code> in
version 0.8.0 and before, the values produced after version 0.8.0 and
the value published in CMH-17-1G are shown below. All of these values
are for B-Basis (90% content, 95% confidence).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">j_pre_080</span>, <span class="op">~</span><span class="va">z_pre_080</span>, <span class="op">~</span><span class="va">j_post_080</span>, <span class="op">~</span><span class="va">z_post_080</span>, <span class="op">~</span><span class="va">j_cmh</span>, <span class="op">~</span><span class="va">z_cmh</span>,</span>
<span>  <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">35.1768141883907</span>, <span class="fl">2</span>, <span class="fl">35.1768141883907</span>, <span class="fl">2</span>, <span class="fl">35.177</span>,</span>
<span>  <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">7.85866787768029</span>, <span class="fl">3</span>, <span class="fl">7.85866787768029</span>, <span class="fl">3</span>, <span class="fl">7.859</span>,</span>
<span>  <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4.50522447199018</span>, <span class="fl">4</span>, <span class="fl">4.50522447199018</span>, <span class="fl">4</span>, <span class="fl">4.505</span>,</span>
<span>  <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4.10074820079326</span>, <span class="fl">4</span>, <span class="fl">4.10074820079326</span>, <span class="fl">4</span>, <span class="fl">4.101</span>,</span>
<span>  <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">3.06444416024793</span>, <span class="fl">5</span>, <span class="fl">3.06444416024793</span>, <span class="fl">5</span>, <span class="fl">3.064</span>,</span>
<span>  <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">2.85751000593839</span>, <span class="fl">5</span>, <span class="fl">2.85751000593839</span>, <span class="fl">5</span>, <span class="fl">2.858</span>,</span>
<span>  <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">2.38240998122575</span>, <span class="fl">6</span>, <span class="fl">2.38240998122575</span>, <span class="fl">6</span>, <span class="fl">2.382</span>,</span>
<span>  <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">2.25292053841772</span>, <span class="fl">6</span>, <span class="fl">2.25292053841772</span>, <span class="fl">6</span>, <span class="fl">2.253</span>,</span>
<span>  <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">1.98762060673102</span>, <span class="fl">6</span>, <span class="fl">2.13665759924781</span>, <span class="fl">6</span>, <span class="fl">2.137</span>,</span>
<span>  <span class="fl">11</span>, <span class="fl">7</span>, <span class="fl">1.89699586212496</span>, <span class="fl">7</span>, <span class="fl">1.89699586212496</span>, <span class="fl">7</span>, <span class="fl">1.897</span>,</span>
<span>  <span class="fl">12</span>, <span class="fl">7</span>, <span class="fl">1.81410756892749</span>, <span class="fl">7</span>, <span class="fl">1.81410756892749</span>, <span class="fl">7</span>, <span class="fl">1.814</span>,</span>
<span>  <span class="fl">13</span>, <span class="fl">8</span>, <span class="fl">1.66223343216608</span>, <span class="fl">7</span>, <span class="fl">1.73773765993598</span>, <span class="fl">7</span>, <span class="fl">1.738</span>,</span>
<span>  <span class="fl">14</span>, <span class="fl">8</span>, <span class="fl">1.59916281901889</span>, <span class="fl">8</span>, <span class="fl">1.59916281901889</span>, <span class="fl">8</span>, <span class="fl">1.599</span>,</span>
<span>  <span class="fl">15</span>, <span class="fl">8</span>, <span class="fl">1.54040000806181</span>, <span class="fl">8</span>, <span class="fl">1.54040000806181</span>, <span class="fl">8</span>, <span class="fl">1.54</span>,</span>
<span>  <span class="fl">16</span>, <span class="fl">9</span>, <span class="fl">1.44512878109546</span>, <span class="fl">8</span>, <span class="fl">1.48539432060546</span>, <span class="fl">8</span>, <span class="fl">1.485</span>,</span>
<span>  <span class="fl">17</span>, <span class="fl">9</span>, <span class="fl">1.39799975474842</span>, <span class="fl">9</span>, <span class="fl">1.39799975474842</span>, <span class="fl">8</span>, <span class="fl">1.434</span>,</span>
<span>  <span class="fl">18</span>, <span class="fl">9</span>, <span class="fl">1.35353033609361</span>, <span class="fl">9</span>, <span class="fl">1.35353033609361</span>, <span class="fl">9</span>, <span class="fl">1.354</span>,</span>
<span>  <span class="fl">19</span>, <span class="fl">10</span>, <span class="fl">1.28991705486727</span>, <span class="fl">9</span>, <span class="fl">1.31146980117942</span>, <span class="fl">9</span>, <span class="fl">1.311</span>,</span>
<span>  <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">1.25290765871981</span>, <span class="fl">9</span>, <span class="fl">1.27163203813793</span>, <span class="fl">10</span>, <span class="fl">1.253</span>,</span>
<span>  <span class="fl">21</span>, <span class="fl">10</span>, <span class="fl">1.21771654027026</span>, <span class="fl">10</span>, <span class="fl">1.21771654027026</span>, <span class="fl">10</span>, <span class="fl">1.218</span>,</span>
<span>  <span class="fl">22</span>, <span class="fl">11</span>, <span class="fl">1.17330587650406</span>, <span class="fl">10</span>, <span class="fl">1.18418267046374</span>, <span class="fl">10</span>, <span class="fl">1.184</span>,</span>
<span>  <span class="fl">23</span>, <span class="fl">11</span>, <span class="fl">1.14324511741536</span>, <span class="fl">10</span>, <span class="fl">1.15218647199938</span>, <span class="fl">11</span>, <span class="fl">1.143</span>,</span>
<span>  <span class="fl">24</span>, <span class="fl">11</span>, <span class="fl">1.11442082880151</span>, <span class="fl">10</span>, <span class="fl">1.12153586685854</span>, <span class="fl">11</span>, <span class="fl">1.114</span>,</span>
<span>  <span class="fl">25</span>, <span class="fl">11</span>, <span class="fl">1.08682185727661</span>, <span class="fl">11</span>, <span class="fl">1.08682185727661</span>, <span class="fl">11</span>, <span class="fl">1.087</span>,</span>
<span>  <span class="fl">26</span>, <span class="fl">11</span>, <span class="fl">1.06032912052507</span>, <span class="fl">11</span>, <span class="fl">1.06032912052507</span>, <span class="fl">11</span>, <span class="fl">1.06</span>,</span>
<span>  <span class="fl">27</span>, <span class="fl">12</span>, <span class="fl">1.03307994274081</span>, <span class="fl">11</span>, <span class="fl">1.03485308510789</span>, <span class="fl">11</span>, <span class="fl">1.035</span>,</span>
<span>  <span class="fl">28</span>, <span class="fl">12</span>, <span class="fl">1.00982188136729</span>, <span class="fl">11</span>, <span class="fl">1.01034609051393</span>, <span class="fl">12</span>, <span class="fl">1.01</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the sample sizes where <span class="math inline">\(j\)</span> is
the same for each approach, the values of <span class="math inline">\(z\)</span> are also equal within a small
tolerance.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">j_pre_080</span> <span class="op">==</span> <span class="va">j_post_080</span> <span class="op">&amp;</span> <span class="va">j_pre_080</span> <span class="op">==</span> <span class="va">j_cmh</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 16 × 7</span></span>
<span><span class="co">#&gt;        n j_pre_080 z_pre_080 j_post_080 z_post_080 j_cmh z_cmh</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     2         2     35.2           2      35.2      2 35.2 </span></span>
<span><span class="co">#&gt;  2     3         3      7.86          3       7.86     3  7.86</span></span>
<span><span class="co">#&gt;  3     4         4      4.51          4       4.51     4  4.50</span></span>
<span><span class="co">#&gt;  4     5         4      4.10          4       4.10     4  4.10</span></span>
<span><span class="co">#&gt;  5     6         5      3.06          5       3.06     5  3.06</span></span>
<span><span class="co">#&gt;  6     7         5      2.86          5       2.86     5  2.86</span></span>
<span><span class="co">#&gt;  7     8         6      2.38          6       2.38     6  2.38</span></span>
<span><span class="co">#&gt;  8     9         6      2.25          6       2.25     6  2.25</span></span>
<span><span class="co">#&gt;  9    11         7      1.90          7       1.90     7  1.90</span></span>
<span><span class="co">#&gt; 10    12         7      1.81          7       1.81     7  1.81</span></span>
<span><span class="co">#&gt; 11    14         8      1.60          8       1.60     8  1.60</span></span>
<span><span class="co">#&gt; 12    15         8      1.54          8       1.54     8  1.54</span></span>
<span><span class="co">#&gt; 13    18         9      1.35          9       1.35     9  1.35</span></span>
<span><span class="co">#&gt; 14    21        10      1.22         10       1.22    10  1.22</span></span>
<span><span class="co">#&gt; 15    25        11      1.09         11       1.09    11  1.09</span></span>
<span><span class="co">#&gt; 16    26        11      1.06         11       1.06    11  1.06</span></span></code></pre></div>
<p>The sample sizes where the value of <span class="math inline">\(j\)</span> differs are as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_diff</span> <span class="op">&lt;-</span> <span class="va">factors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">j_pre_080</span> <span class="op">!=</span> <span class="va">j_post_080</span> <span class="op">|</span> <span class="va">j_pre_080</span> <span class="op">!=</span> <span class="va">j_cmh</span> <span class="op">|</span> <span class="va">j_post_080</span> <span class="op">!=</span> <span class="va">j_cmh</span><span class="op">)</span></span>
<span><span class="va">factor_diff</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;        n j_pre_080 z_pre_080 j_post_080 z_post_080 j_cmh z_cmh</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    10         7      1.99          6       2.14     6  2.14</span></span>
<span><span class="co">#&gt;  2    13         8      1.66          7       1.74     7  1.74</span></span>
<span><span class="co">#&gt;  3    16         9      1.45          8       1.49     8  1.48</span></span>
<span><span class="co">#&gt;  4    17         9      1.40          9       1.40     8  1.43</span></span>
<span><span class="co">#&gt;  5    19        10      1.29          9       1.31     9  1.31</span></span>
<span><span class="co">#&gt;  6    20        10      1.25          9       1.27    10  1.25</span></span>
<span><span class="co">#&gt;  7    22        11      1.17         10       1.18    10  1.18</span></span>
<span><span class="co">#&gt;  8    23        11      1.14         10       1.15    11  1.14</span></span>
<span><span class="co">#&gt;  9    24        11      1.11         10       1.12    11  1.11</span></span>
<span><span class="co">#&gt; 10    27        12      1.03         11       1.03    11  1.03</span></span>
<span><span class="co">#&gt; 11    28        12      1.01         11       1.01    12  1.01</span></span></code></pre></div>
<p>While there are differences in the three implementations, it’s not
clear how much these differences will matter in terms of the tolerance
limits calculated. This can be investigated through simulation.</p>
<div class="section level2">
<h2 id="simulation-with-normally-distributed-data">Simulation with Normally Distributed Data<a class="anchor" aria-label="anchor" href="#simulation-with-normally-distributed-data"></a>
</h2>
<p>First, we’ll generate a large number (10,000) of samples of sample
size <span class="math inline">\(n\)</span> from a normal distribution.
Since we’re generating the samples, we know the true population
parameters, so can calculate the true population quantiles. We’ll use
the three sets of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> values to compute tolerance limits and
compared those tolerance limits to the population quantiles. The
proportion of the calculated tolerance limits below the population
quantiles should be equal to the selected confidence. We’ll restrict the
simulation study to the sample sizes where the values of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> differ in the three implementations of
this method, and we’ll consider B-Basis (90% content, 95%
confidence).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_normal</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">sd_normal</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span>  <span class="co"># make this reproducible</span></span>
<span></span>
<span><span class="va">tolerance_limit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">j</span>, <span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="va">z</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">pmap_dfr</a></span><span class="op">(</span><span class="va">factor_diff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">j_pre_080</span>, <span class="va">z_pre_080</span>,</span>
<span>                                             <span class="va">j_post_080</span>, <span class="va">z_post_080</span>,</span>
<span>                                             <span class="va">j_cmh</span>, <span class="va">z_cmh</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu_normal</span>, <span class="va">sd_normal</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      b_pre_080 <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_pre_080</span>, <span class="va">z_pre_080</span><span class="op">)</span>,</span>
<span>      b_post_080 <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_post_080</span>, <span class="va">z_post_080</span><span class="op">)</span>,</span>
<span>      b_cmh <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_cmh</span>, <span class="va">z_cmh</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">sim_normal</span></span>
<span><span class="co">#&gt; # A tibble: 110,000 × 5</span></span>
<span><span class="co">#&gt;        n b_pre_080 b_post_080 b_cmh x         </span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    </span></span>
<span><span class="co">#&gt;  1    10      78.4       77.7  77.7 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  2    10      82.8       82.0  82.0 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  3    10      83.3       83.0  83.0 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  4    10      78.4       77.2  77.2 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  5    10      87.3       86.6  86.6 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  6    10      92.3       93.2  93.2 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  7    10      75.2       77.9  77.9 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  8    10      75.4       73.9  73.9 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  9    10      75.5       75.1  75.1 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt; 10    10      76.4       78.4  78.4 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt; # … with 109,990 more rows</span></span></code></pre></div>
<p>One can see that the tolerance limits calculated with each set of
factors for (most) data sets is different. However, this does not
necessarily mean that any set of factors is more or less correct.</p>
<p>The distribution of the tolerance limits for each sample size is as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_normal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">b_pre_080</span><span class="op">:</span><span class="va">b_cmh</span>, names_to <span class="op">=</span> <span class="st">"Factors"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">n</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of Tolerance Limits for Various Values of n"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="distribution-normal-1.png" alt="plot of chunk distribution-normal"><div class="figcaption">plot of chunk distribution-normal</div>
</div>
<p>For all samples sizes, the distribution of tolerance limits is
actually very similar between all three sets of factors.</p>
<p>The true population quantile can be calculated as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_p_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">mu_normal</span>, <span class="va">sd_normal</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">x_p_normal</span></span>
<span><span class="co">#&gt; [1] 92.31069</span></span></code></pre></div>
<p>The proportion of calculated tolerance limit values that are below
the population quantile can be calculated as follows. We see that the in
all cases the tolerance limits are all conservative, and also that each
set of factors produce similar levels of conservatism.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_normal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>below_pre_080 <span class="op">=</span> <span class="va">b_pre_080</span> <span class="op">&lt;</span> <span class="va">x_p_normal</span>,</span>
<span>         below_post_080 <span class="op">=</span> <span class="va">b_post_080</span> <span class="op">&lt;</span> <span class="va">x_p_normal</span>,</span>
<span>         below_cmh <span class="op">=</span> <span class="va">b_cmh</span> <span class="op">&lt;</span> <span class="va">x_p_normal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    prop_below_pre_080 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_pre_080</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    prop_below_post_080 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_post_080</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    prop_below_cmh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_cmh</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 4</span></span>
<span><span class="co">#&gt;        n prop_below_pre_080 prop_below_post_080 prop_below_cmh</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;              &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    10              0.984               0.980          0.980</span></span>
<span><span class="co">#&gt;  2    13              0.979               0.975          0.975</span></span>
<span><span class="co">#&gt;  3    16              0.969               0.967          0.967</span></span>
<span><span class="co">#&gt;  4    17              0.973               0.973          0.971</span></span>
<span><span class="co">#&gt;  5    19              0.962               0.961          0.961</span></span>
<span><span class="co">#&gt;  6    20              0.964               0.962          0.964</span></span>
<span><span class="co">#&gt;  7    22              0.961               0.960          0.960</span></span>
<span><span class="co">#&gt;  8    23              0.960               0.959          0.960</span></span>
<span><span class="co">#&gt;  9    24              0.962               0.961          0.962</span></span>
<span><span class="co">#&gt; 10    27              0.954               0.953          0.954</span></span>
<span><span class="co">#&gt; 11    28              0.952               0.952          0.952</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-with-weibull-data">Simulation with Weibull Data<a class="anchor" aria-label="anchor" href="#simulation-with-weibull-data"></a>
</h2>
<p>Next, we’ll do a similar simulation using data drawn from a Weibull
distribution. Again, we’ll generate 10,000 samples for each sample
size.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shape_weibull</span> <span class="op">&lt;-</span> <span class="fl">60</span></span>
<span><span class="va">scale_weibull</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">234568</span><span class="op">)</span>  <span class="co"># make this reproducible</span></span>
<span></span>
<span><span class="va">sim_weibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">pmap_dfr</a></span><span class="op">(</span><span class="va">factor_diff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">j_pre_080</span>, <span class="va">z_pre_080</span>,</span>
<span>                                              <span class="va">j_post_080</span>, <span class="va">z_post_080</span>,</span>
<span>                                              <span class="va">j_cmh</span>, <span class="va">z_cmh</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">shape_weibull</span>, <span class="va">scale_weibull</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="va">n</span>,</span>
<span>      b_pre_080 <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_pre_080</span>, <span class="va">z_pre_080</span><span class="op">)</span>,</span>
<span>      b_post_080 <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_post_080</span>, <span class="va">z_post_080</span><span class="op">)</span>,</span>
<span>      b_cmh <span class="op">=</span> <span class="fu">tolerance_limit</span><span class="op">(</span><span class="va">x</span>, <span class="va">j_cmh</span>, <span class="va">z_cmh</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">sim_weibull</span></span>
<span><span class="co">#&gt; # A tibble: 110,000 × 5</span></span>
<span><span class="co">#&gt;        n b_pre_080 b_post_080 b_cmh x         </span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    </span></span>
<span><span class="co">#&gt;  1    10      95.3       95.1  95.1 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  2    10      88.5       88.3  88.3 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  3    10      89.7       89.3  89.3 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  4    10      94.7       94.4  94.4 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  5    10      96.9       96.9  96.9 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  6    10      93.6       93.2  93.2 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  7    10      86.1       85.5  85.5 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  8    10      91.9       91.9  91.9 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt;  9    10      93.7       93.4  93.4 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt; 10    10      90.9       90.4  90.4 &lt;dbl [10]&gt;</span></span>
<span><span class="co">#&gt; # … with 109,990 more rows</span></span></code></pre></div>
<p>The distribution of the tolerance limits for each sample size is as
follows. Once again, we see that the distribution of tolerance limits is
nearly identical when each of the three sets of factors are used.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_weibull</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">b_pre_080</span><span class="op">:</span><span class="va">b_cmh</span>, names_to <span class="op">=</span> <span class="st">"Factors"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">n</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of Tolerance Limits for Various Values of n"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="distribution-Weibull-1.png" alt="plot of chunk distribution-Weibull"><div class="figcaption">plot of chunk distribution-Weibull</div>
</div>
<p>The true population quantile can be calculated as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_p_weibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">qweibull</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">shape_weibull</span>, <span class="va">scale_weibull</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">x_p_weibull</span></span>
<span><span class="co">#&gt; [1] 96.31885</span></span></code></pre></div>
<p>The proportion of calculated tolerance limit values that are below
the population quantile can be calculated as follows. We see that the in
all roughly 95% or more of the tolerance limits calculated for each
sample is below the population quantile. We also see very similar
proportions for each of the three sets of factors considered.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_weibull</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>below_pre_080 <span class="op">=</span> <span class="va">b_pre_080</span> <span class="op">&lt;</span> <span class="va">x_p_weibull</span>,</span>
<span>         below_post_080 <span class="op">=</span> <span class="va">b_post_080</span> <span class="op">&lt;</span> <span class="va">x_p_weibull</span>,</span>
<span>         below_cmh <span class="op">=</span> <span class="va">b_cmh</span> <span class="op">&lt;</span> <span class="va">x_p_weibull</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    prop_below_pre_080 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_pre_080</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    prop_below_post_080 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_post_080</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    prop_below_cmh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">below_cmh</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 4</span></span>
<span><span class="co">#&gt;        n prop_below_pre_080 prop_below_post_080 prop_below_cmh</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;              &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    10              0.97                0.965          0.965</span></span>
<span><span class="co">#&gt;  2    13              0.966               0.964          0.964</span></span>
<span><span class="co">#&gt;  3    16              0.959               0.959          0.959</span></span>
<span><span class="co">#&gt;  4    17              0.961               0.961          0.96 </span></span>
<span><span class="co">#&gt;  5    19              0.957               0.956          0.956</span></span>
<span><span class="co">#&gt;  6    20              0.955               0.954          0.955</span></span>
<span><span class="co">#&gt;  7    22              0.953               0.952          0.952</span></span>
<span><span class="co">#&gt;  8    23              0.950               0.950          0.950</span></span>
<span><span class="co">#&gt;  9    24              0.953               0.953          0.953</span></span>
<span><span class="co">#&gt; 10    27              0.952               0.951          0.951</span></span>
<span><span class="co">#&gt; 11    28              0.950               0.950          0.950</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The values of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> computed by the
<code>kh_Ext_z_j_opt</code> function differs for certain samples sizes
(<span class="math inline">\(n\)</span>) before and after version 0.8.0.
Furthermore, for certain sample sizes, these values differ from those
published in CMH-17-1G. The simulation study presented in this vignette
shows that the tolerance limit (Basis value) might differ for any
individual sample based on which set of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span> are used. However, each set of factors
produces tolerance limit factors that are either correct or
conservative. These three methods have very similar performance, and
tolerance limits produced with any of these three methods are equally
valid.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>This vignette is computed in advance. A system with the following
configuration was used:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.1.1 (2021-08-10)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 20.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8    LC_PAPER=en_CA.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] tidyr_1.1.4   purrr_0.3.4   ggplot2_3.3.5 dplyr_1.0.7  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.1.1  xfun_0.26         remotes_2.4.0     colorspace_2.0-2  vctrs_0.3.8       generics_0.1.0   </span></span>
<span><span class="co">#&gt;  [7] testthat_3.0.4    htmltools_0.5.2   usethis_2.0.1     yaml_2.2.1        utf8_1.2.2        rlang_0.4.11.9001</span></span>
<span><span class="co">#&gt; [13] pkgbuild_1.2.0    pillar_1.6.3      glue_1.4.2        withr_2.4.2       DBI_1.1.1         waldo_0.3.1      </span></span>
<span><span class="co">#&gt; [19] cmstatr_0.9.0     sessioninfo_1.1.1 lifecycle_1.0.1   stringr_1.4.0     munsell_0.5.0     gtable_0.3.0     </span></span>
<span><span class="co">#&gt; [25] devtools_2.4.2    memoise_2.0.0     evaluate_0.14     labeling_0.4.2    knitr_1.35        callr_3.7.0      </span></span>
<span><span class="co">#&gt; [31] fastmap_1.1.0     ps_1.6.0          curl_4.3.1        fansi_0.5.0       highr_0.9         scales_1.1.1     </span></span>
<span><span class="co">#&gt; [37] kSamples_1.2-9    cachem_1.0.6      desc_1.4.0        pkgload_1.2.2     farver_2.1.0      fs_1.5.0         </span></span>
<span><span class="co">#&gt; [43] digest_0.6.28     stringi_1.7.4     processx_3.5.2    SuppDists_1.1-9.5 rprojroot_2.0.2   grid_4.1.1       </span></span>
<span><span class="co">#&gt; [49] cli_3.0.1         tools_4.1.1       magrittr_2.0.1    tibble_3.1.4      crayon_1.4.1      pkgconfig_2.0.3  </span></span>
<span><span class="co">#&gt; [55] MASS_7.3-54       ellipsis_0.3.2    prettyunits_1.1.1 assertthat_0.2.1  rmarkdown_2.11    rstudioapi_0.13  </span></span>
<span><span class="co">#&gt; [61] R6_2.5.1          compiler_4.1.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0">
<div id="ref-Vangel1994" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">M.
Vangel, <span>“<a href="https://doi.org/10.1080/03610919408813222" class="external-link">One-Sided Nonparametric
Tolerance Limits</a>,”</span> <em>Communications in Statistics -
Simulation and Computation</em>, vol. 23, no. 4. pp. 1137–1154,
1994.</div>
</div>
<div id="ref-Hanson1964" class="csl-entry">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">D.
L. Hanson and L. H. Koopmans, <span>“<a href="https://doi.org/10.1214/aoms/1177700380" class="external-link">Tolerance Limits for the
Class of Distributions with Increasing Hazard Rates</a>,”</span> <em>The
Annals of Mathematical Statistics</em>, vol. 35, no. 4. pp. 1561–1570,
1964.</div>
</div>
<div id="ref-Harter1961" class="csl-entry">
<div class="csl-left-margin">[3] </div>
<div class="csl-right-inline">H.
L. Harter, <span>“<a href="https://doi.org/10.2307/2333139" class="external-link">Expected
values of normal order statistics</a>,”</span> <em>Biometrika</em>, vol.
48, no. 1/2. pp. 151–165, 1961.</div>
</div>
<div id="ref-CMH-17-1G" class="csl-entry">
<div class="csl-left-margin">[4] </div>
<div class="csl-right-inline">
<span>“Composite Materials Handbook, Volume 1.
Polymer Matrix Composites Guideline for Characterization of Structural
Materials,”</span> SAE International, CMH-17-1G, Mar. 2012.</div>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>The <span class="math inline">\(i\)</span><code>th</code> order statistic is the
<span class="math inline">\(i\)</span><code>th</code> lowest value in
the sample.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Note that CMH-17-1G uses the symbols <span class="math inline">\(r\)</span> and <span class="math inline">\(k\)</span> instead of <span class="math inline">\(j\)</span> and <span class="math inline">\(z\)</span>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.kloppenborg.ca" class="external-link">Stefan Kloppenborg</a>, Comtek Advanced Structures, Ltd..</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
