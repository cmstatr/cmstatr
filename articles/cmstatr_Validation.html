<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cmstatr Validation • cmstatr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="cmstatr Validation">
<meta property="og:description" content="cmstatr">
<meta property="og:image" content="www.cmstatr.net/reference/figures/logo-240x278.png">
<meta property="og:image:alt" content="Statistical methods for composite material data: cmstatr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmstatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adktest.html">Anderson-Darling k-Sample Test</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Graphing.html">Plotting Composite Material Data</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Tutorial.html">cmstatr Tutorial</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Validation.html">cmstatr Validation</a>
    </li>
    <li>
      <a href="../articles/hk_ext.html">Extended Hanson-Koopmans</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cmstatr/cmstatr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cmstatr_Validation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>cmstatr Validation</h1>
                        <h4 class="author">Stefan Kloppenborg</h4>
            
            <h4 class="date">2021-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cmstatr/cmstatr/blob/master/vignettes/cmstatr_Validation.Rmd"><code>vignettes/cmstatr_Validation.Rmd</code></a></small>
      <div class="hidden name"><code>cmstatr_Validation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h1>
<p>This vignette is intended to contain the same validation that is included in the test suite within the <code>cmstatr</code> package, but in a format that is easier for a human to read. The intent is that this vignette will include only those validations that are included in the test suite, but that the test suite may include more tests than are shown in this vignette.</p>
<p>The following packages will be used in this validation. The version of each package used is listed at the end of this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.cmstatr.net/">cmstatr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org">testthat</a></span><span class="op">)</span></code></pre></div>
<p>Throughout this vignette, the <code>testthat</code> package will be used. Expressions such as <code>expect_equal</code> are used to ensure that the two values are equal (within some tolerance). If this expectation is not true, the vignette will fail to build. The tolerance is a relative tolerance: a tolerance of 0.01 means that the two values must be within <span class="math inline">\(1\%\)</span> of each other. As an example, the following expression checks that the value <code>10</code> is equal to <code>10.1</code> within a tolerance of <code>0.01</code>. Such an expectation should be satisfied.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10.1</span>, tolerance <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<p>The <code>basis_...</code> functions automatically perform certain diagnostic tests. When those diagnostic tests are not relevant to the validation, the diagnostic tests are overridden by passing the argument <code>override = "all"</code>.</p>
</div>
<div id="validation-table" class="section level1">
<h1 class="hasAnchor">
<a href="#validation-table" class="anchor"></a>2. Validation Table</h1>
<p>The following table provides a cross-reference between the various functions of the <code>cmstatr</code> package and the tests shown within this vignette. The sections in this vignette are organized by data set. Not all checks are performed on all data sets.</p>
<table class="table">
<thead><tr class="header">
<th>Function</th>
<th>Tests</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/ad_ksample.html">ad_ksample()</a></code></td>
<td>
<a href="#cf-ad">Section 3.1</a>, <a href="#c11-adk">Section 4.1.2</a>, <a href="#cl-adk">Section 6.1</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/anderson_darling.html">anderson_darling_normal()</a></code></td>
<td>
<a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adn">Section 5.1</a>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/anderson_darling.html">anderson_darling_lognormal()</a></code></td>
<td>
<a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adl">Section 5.2</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/anderson_darling.html">anderson_darling_weibull()</a></code></td>
<td>
<a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adw">Section 5.3</a>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/basis.html">basis_normal()</a></code></td>
<td><a href="#ods-nb">Section 5.4</a></td>
</tr>
<tr class="even">
<td><code><a href="../reference/basis.html">basis_lognormal()</a></code></td>
<td><a href="#ods-lb">Section 5.5</a></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/basis.html">basis_weibull()</a></code></td>
<td><a href="#ods-wb">Section 5.6</a></td>
</tr>
<tr class="even">
<td><code><a href="../reference/basis.html">basis_pooled_cv()</a></code></td>
<td>
<a href="#c12-pcv">Section 4.2.3</a>, <a href="#c12-pcvmcv">Section 4.2.4</a>,</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/basis.html">basis_pooled_sd()</a></code></td>
<td>
<a href="#c12-psd">Section 4.2.1</a>, <a href="#c12-psdmcv">Section 4.2.2</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/basis.html">basis_hk_ext()</a></code></td>
<td>
<a href="#c11-hk-wf">Section 4.1.6</a>, <a href="#ods-hkb">Section 5.7</a>, <a href="#ods-hkb2">Section 5.8</a>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/basis.html">basis_nonpara_large_sample()</a></code></td>
<td><a href="#ods-lsnb">Section 5.9</a></td>
</tr>
<tr class="even">
<td><code><a href="../reference/basis.html">basis_anova()</a></code></td>
<td><a href="#c11-anova">Section 4.1.7</a></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/calc_cv_star.html">calc_cv_star()</a></code></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="../reference/cv.html">cv()</a></code></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/equiv_change_mean.html">equiv_change_mean()</a></code></td>
<td><a href="#ods-ecm">Section 5.11</a></td>
</tr>
<tr class="even">
<td><code><a href="../reference/equiv_mean_extremum.html">equiv_mean_extremum()</a></code></td>
<td><a href="#ods-eme">Section 5.10</a></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/hk_ext.html">hk_ext_z()</a></code></td>
<td>
<a href="#pf-hk">Section 7.3</a>, <a href="#pf-hk2">Section 7.4</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/hk_ext.html">hk_ext_z_j_opt()</a></code></td>
<td><a href="#pf-hk-opt">Section 7.5</a></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/k_equiv.html">k_equiv()</a></code></td>
<td><a href="#pf-equiv">Section 7.8</a></td>
</tr>
<tr class="even">
<td><code><a href="../reference/k_factor_normal.html">k_factor_normal()</a></code></td>
<td>
<a href="#pf-kb">Section 7.1</a>, <a href="#pf-ka">Section 7.2</a>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/levene_test.html">levene_test()</a></code></td>
<td>
<a href="#c11-lbc">Section 4.1.4</a>, <a href="#c11-lbb">Section 4.1.5</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/maximum_normed_residual.html">maximum_normed_residual()</a></code></td>
<td><a href="#c11-mnr">Section 4.1.1</a></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/nonpara_binomial_rank.html">nonpara_binomial_rank()</a></code></td>
<td>
<a href="#pf-npbinom">Section 7.6</a>, <a href="#pf-npbinom2">Section 7.7</a>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_group_mean.html">normalize_group_mean()</a></code></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_ply_thickness.html">normalize_ply_thickness()</a></code></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="../reference/transform_mod_cv.html">transform_mod_cv_ad()</a></code></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/transform_mod_cv.html">transform_mod_cv()</a></code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="carbon-fabric-data-set" class="section level1">
<h1 class="hasAnchor">
<a href="#carbon-fabric-data-set" class="anchor"></a>3. <code>carbon.fabric</code> Data Set</h1>
<p>This data set is example data that is provided with <code>cmstatr</code>. The first few rows of this data are shown below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">carbon.fabric</span><span class="op">)</span>
<span class="co">#&gt;           id test condition batch strength</span>
<span class="co">#&gt; 1 WT-RTD-1-1   WT       RTD     1 137.4438</span>
<span class="co">#&gt; 2 WT-RTD-1-2   WT       RTD     1 139.5395</span>
<span class="co">#&gt; 3 WT-RTD-1-3   WT       RTD     1 150.8900</span>
<span class="co">#&gt; 4 WT-RTD-1-4   WT       RTD     1 141.4474</span>
<span class="co">#&gt; 5 WT-RTD-1-5   WT       RTD     1 141.8203</span>
<span class="co">#&gt; 6 WT-RTD-1-6   WT       RTD     1 151.8821</span></code></pre></div>
<div id="cf-ad" class="section level2">
<h2 class="hasAnchor">
<a href="#cf-ad" class="anchor"></a>3.1. Anderson–Darling k-Sample Test</h2>
<p>This data was entered into ASAP 2008 <span class="citation">[1]</span> and the reported Anderson–Darling k–Sample test statistics were recorded, as were the conclusions.</p>
<p>The value of the test statistic reported by <code>cmstatr</code> and that reported by ASAP 2008 differ by a factor of <span class="math inline">\(k - 1\)</span>, as do the critical values used. As such, the conclusion of the tests are identical. This is described in more detail in the <a href="adktest.html">Anderson–Darling k–Sample Vignette</a>.</p>
<p>When the RTD warp-tension data from this data set is entered into ASAP 2008, it reports a test statistic of 0.456 and fails to reject the null hypothesis that the batches are drawn from the same distribution. Adjusting for the different definition of the test statistic, the results given by <code>cmstatr</code> are very similar.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">carbon.fabric</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">test</span> <span class="op">==</span> <span class="st">"WT"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/ad_ksample.html">ad_ksample</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ad</span> <span class="op">/</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">0.456</span>, tolerance <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_false</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">reject_same_dist</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 18           k = 3            </span>
<span class="co">#&gt; ADK = 0.912      p-value = 0.95989 </span>
<span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></code></pre></div>
<p>When the ETW warp-tension data from this data set are entered into ASAP 2008, the reported test statistic is 1.604 and it fails to reject the null hypothesis that the batches are drawn from the same distribution. Adjusting for the different definition of the test statistic, <code>cmstatr</code> gives nearly identical results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">carbon.fabric</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">test</span> <span class="op">==</span> <span class="st">"WT"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/ad_ksample.html">ad_ksample</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ad</span> <span class="op">/</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">1.604</span>, tolerance <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_false</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">reject_same_dist</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 18           k = 3            </span>
<span class="co">#&gt; ADK = 3.21       p-value = 0.10208 </span>
<span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></code></pre></div>
</div>
</div>
<div id="comparison-with-examples-from-cmh-17-1g" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-examples-from-cmh-17-1g" class="anchor"></a>4. Comparison with Examples from CMH-17-1G</h1>
<div id="dataset-from-section-8-3-11-1-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-from-section-8-3-11-1-1" class="anchor"></a>4.1 Dataset From Section 8.3.11.1.1</h2>
<p>CMH-17-1G <span class="citation">[2]</span> provides an example data set and results from ASAP <span class="citation">[1]</span> and STAT17 <span class="citation">[3]</span>. This example data set is duplicated below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_8_3_11_1_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">batch</span>, <span class="op">~</span><span class="va">strength</span>, <span class="op">~</span><span class="va">condition</span>,
  <span class="fl">1</span>, <span class="fl">118.3774604</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">84.9581364</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">83.7436035</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">123.6035612</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">92.4891822</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">84.3831677</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">115.2238092</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">96.8212659</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">94.8030433</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">112.6379744</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">109.030325</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">94.3931537</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">116.5564277</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">97.8212659</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">101.702222</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">123.1649896</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">100.921519</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">86.5372121</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">128.5589027</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">103.699444</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">92.3772684</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">113.1462103</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">93.7908212</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">89.2084024</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">121.4248107</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">107.526709</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">100.686001</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">134.3241906</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">94.5769704</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">81.0444192</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">129.6405117</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">93.8831373</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">91.3398070</span>, <span class="st">"ETD"</span>,
  <span class="fl">2</span>, <span class="fl">117.9818658</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">98.2296605</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">93.1441939</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">115.4505226</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">111.346590</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">85.8204168</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">120.0369467</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">100.817538</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">94.8966273</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">117.1631088</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">100.382203</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">95.8068520</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">112.9302797</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">91.5037811</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">86.7842252</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">117.9114501</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">100.083233</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">94.4011973</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">120.1900159</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">95.6393615</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">96.7231171</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">110.7295966</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">109.304779</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">89.9010384</span>, <span class="st">"ETD"</span>,
  <span class="fl">3</span>, <span class="fl">100.078562</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">99.1205847</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">89.3672306</span>, <span class="st">"ETD"</span>,
  <span class="fl">1</span>, <span class="fl">106.357525</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">99.0239966</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">105.898733</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">103.341238</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">88.4640082</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">100.302130</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">103.901744</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">98.4634133</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">80.2058219</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">92.2647280</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">109.199597</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">103.487693</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">61.0139431</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">113.734763</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">99.3207107</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">108.172659</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">115.861770</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">108.426732</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">82.6133082</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">116.260375</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">85.3690411</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">121.049610</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">115.801622</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">111.223082</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">44.3217741</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">104.574843</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">117.328077</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">103.222552</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">88.6782903</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">99.3918538</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">107.676986</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">87.3421658</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">108.960241</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">102.730741</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">116.122640</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">96.3694916</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">80.2334815</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">99.5946088</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">106.145570</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">97.0712407</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">104.667866</span>, <span class="st">"ETW"</span>,
  <span class="fl">3</span>, <span class="fl">104.234953</span>, <span class="st">"ETW"</span>
<span class="op">)</span>
<span class="va">dat_8_3_11_1_1</span>
<span class="co">#&gt; # A tibble: 102 × 3</span>
<span class="co">#&gt;    batch strength condition</span>
<span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1     1    118.  CTD      </span>
<span class="co">#&gt;  2     1     85.0 RTD      </span>
<span class="co">#&gt;  3     1     83.7 ETD      </span>
<span class="co">#&gt;  4     1    124.  CTD      </span>
<span class="co">#&gt;  5     1     92.5 RTD      </span>
<span class="co">#&gt;  6     1     84.4 ETD      </span>
<span class="co">#&gt;  7     1    115.  CTD      </span>
<span class="co">#&gt;  8     1     96.8 RTD      </span>
<span class="co">#&gt;  9     1     94.8 ETD      </span>
<span class="co">#&gt; 10     1    113.  CTD      </span>
<span class="co">#&gt; # … with 92 more rows</span></code></pre></div>
<div id="c11-mnr" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-mnr" class="anchor"></a>4.1.1 Maximum Normed Residual Test</h3>
<p>CMH-17-1G Table 8.3.11.1.1(a) provides results of the MNR test from ASAP for this data set. Batches 2 and 3 of the ETW data is considered here and the results of <code>cmstatr</code> are compared with those published in CMH-17-1G.</p>
<p>For Batch 2 of the ETW data, the results match those published in the handbook within a small tolerance. The published test statistic is 2.008.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span> <span class="op">&amp;</span> <span class="va">batch</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/maximum_normed_residual.html">maximum_normed_residual</a></span><span class="op">(</span><span class="va">strength</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">mnr</span>, <span class="fl">2.008</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">crit</span>, <span class="fl">2.127</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">n_outliers</span>, <span class="fl">0</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; maximum_normed_residual(data = ., x = strength, alpha = 0.05)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MNR = 2.008274  ( critical value = 2.126645 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; No outliers detected ( alpha = 0.05 )</span></code></pre></div>
<p>Similarly, for Batch 3 of the ETW data, the results of <code>cmstatr</code> match the results published in the handbook within a small tolerance. The published test statistic is 2.119</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span> <span class="op">&amp;</span> <span class="va">batch</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/maximum_normed_residual.html">maximum_normed_residual</a></span><span class="op">(</span><span class="va">strength</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">mnr</span>, <span class="fl">2.119</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">crit</span>, <span class="fl">2.020</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">n_outliers</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; maximum_normed_residual(data = ., x = strength, alpha = 0.05)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MNR = 2.119175  ( critical value = 2.019969 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Outliers ( alpha = 0.05 ):</span>
<span class="co">#&gt;    Index    Value            </span>
<span class="co">#&gt;        4    80.23348</span></code></pre></div>
</div>
<div id="c11-adk" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-adk" class="anchor"></a>4.1.2 Anderson–Darling k–Sample Test</h3>
<p>For the ETW condition, the ADK test statistic given in <span class="citation">[2]</span> is <span class="math inline">\(ADK = 0.793\)</span> and the test concludes that the samples come from the same distribution. Noting that <code>cmstatr</code> uses the definition of the test statistic given in <span class="citation">[4]</span>, so the test statistic given by <code>cmstatr</code> differs from that given by ASAP by a factor of <span class="math inline">\(k - 1\)</span>, as described in the <a href="adktest.html">Anderson–Darling k–Sample Vignette</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/ad_ksample.html">ad_ksample</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ad</span> <span class="op">/</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">0.793</span>, tolerance <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_false</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">reject_same_dist</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 22           k = 3            </span>
<span class="co">#&gt; ADK = 1.59       p-value = 0.59491 </span>
<span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></code></pre></div>
<p>Similarly, for the ETW2 condition, the test statistic given in <span class="citation">[2]</span> is <span class="math inline">\(ADK = 3.024\)</span> and the test concludes that the samples come from different distributions. This matches <code>cmstatr</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/ad_ksample.html">ad_ksample</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ad</span> <span class="op">/</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">3.024</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_true</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">reject_same_dist</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 20           k = 3            </span>
<span class="co">#&gt; ADK = 6.05       p-value = 0.0042703 </span>
<span class="co">#&gt; Conclusion: Samples do not come from the same distribution (alpha = 0.025 )</span></code></pre></div>
</div>
<div id="c11-ad" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-ad" class="anchor"></a>4.1.3 Anderson–Darling Tests for Distribution</h3>
<p>CMH-17-1G Section 8.3.11.2.1 contains results from STAT17 for the “observed significance level” from the Anderson–Darling test for various distributions. In this section, the ETW condition from the present data set is used. The published results are given in the following table. The results from <code>cmstatr</code> are below and are very similar to those from STAT17.</p>
<table class="table">
<thead><tr class="header">
<th>Distribution</th>
<th>OSL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Normal</td>
<td>0.006051</td>
</tr>
<tr class="even">
<td>Lognormal</td>
<td>0.000307</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td>0.219</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_normal</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.006051</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_normal(data = ., x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal ( n = 22 ) </span>
<span class="co">#&gt; Test statistic:  A = 1.052184 </span>
<span class="co">#&gt; OSL (p-value):  0.006051441  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is not drawn from a Normal distribution ( alpha = 0.05 )</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_lognormal</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.000307</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_lognormal(data = ., x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Lognormal ( n = 22 ) </span>
<span class="co">#&gt; Test statistic:  A = 1.568825 </span>
<span class="co">#&gt; OSL (p-value):  0.0003073592  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is not drawn from a Lognormal distribution ( alpha = 0.05 )</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_weibull</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.0219</span>, tolerance <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_weibull(data = ., x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Weibull ( n = 22 ) </span>
<span class="co">#&gt; Test statistic:  A = 0.8630665 </span>
<span class="co">#&gt; OSL (p-value):  0.02186889  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is not drawn from a Weibull distribution ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="c11-lbc" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-lbc" class="anchor"></a>4.1.4 Levene’s Test (Between Conditions)</h3>
<p>CMH-17-1G Section 8.3.11.1.1 provides results from ASAP for Levene’s test for equality of variance between conditions after the ETW and ETW2 conditions are removed. The handbook shows an F statistic of 0.58, however if this data is entered into ASAP directly, ASAP gives an F statistic of 0.058, which matches the result of <code>cmstatr</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW"</span> <span class="op">&amp;</span> <span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/levene_test.html">levene_test</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">f</span>, <span class="fl">0.058</span>, tolerance <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; levene_test(data = ., x = strength, groups = condition)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; n = 60           k = 3            </span>
<span class="co">#&gt; F = 0.05811631   p-value = 0.943596 </span>
<span class="co">#&gt; Conclusion: Samples have equal variances ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="c11-lbb" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-lbb" class="anchor"></a>4.1.5 Levene’s Test (Between Batches)</h3>
<p>CMH-17-1G Section 8.3.11.2.2 provides output from STAT17. The ETW2 condition from the present data set was analyzed by STAT17 and that software reported an F statistic of 0.123 from Levene’s test when comparing the variance of the batches within this condition. The result from <code>cmstatr</code> is similar.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/levene_test.html">levene_test</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">f</span>, <span class="fl">0.123</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; levene_test(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; n = 20           k = 3            </span>
<span class="co">#&gt; F = 0.1233937    p-value = 0.8847 </span>
<span class="co">#&gt; Conclusion: Samples have equal variances ( alpha = 0.05 )</span></code></pre></div>
<p>Similarly, the published value of the F statistic for the CTD condition is <span class="math inline">\(3.850\)</span>. <code>cmstatr</code> produces very similar results.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/levene_test.html">levene_test</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">f</span>, <span class="fl">3.850</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; levene_test(data = ., x = strength, groups = batch)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; n = 19           k = 3            </span>
<span class="co">#&gt; F = 3.852032     p-value = 0.04309008 </span>
<span class="co">#&gt; Conclusion: Samples have unequal variance ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="c11-hk-wf" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-hk-wf" class="anchor"></a>4.1.6 Nonparametric Basis Values</h3>
<p>CMH-17-1G Section 8.3.11.2.1 provides STAT17 outputs for the ETW condition of the present data set. The nonparametric Basis values are listed. In this case, the Hanson–Koopmans method is used. The published A-Basis value is 13.0 and the B-Basis is 37.9.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span><span class="va">strength</span>, method <span class="op">=</span> <span class="st">"woodward-frawley"</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
               override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">13.0</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(data = ., x = strength, p = 0.99, conf = 0.95, method = "woodward-frawley", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, Woodward-Frawley method)     ( n = 22 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 12.99614</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span><span class="va">strength</span>, method <span class="op">=</span> <span class="st">"optimum-order"</span>, p <span class="op">=</span> <span class="fl">0.90</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
               override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">37.9</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(data = ., x = strength, p = 0.9, conf = 0.95, method = "optimum-order", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 22 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 37.88511</span></code></pre></div>
</div>
<div id="c11-anova" class="section level3">
<h3 class="hasAnchor">
<a href="#c11-anova" class="anchor"></a>4.1.7 Single-Point ANOVA Basis Value</h3>
<p>CMH-17-1G Section 8.3.11.2.2 provides output from STAT17 for the ETW2 condition from the present data set. STAT17 reports A- and B-Basis values based on the ANOVA method of 34.6 and 63.2, respectively. The results from <code>cmstatr</code> are similar.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_anova</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span>, override <span class="op">=</span> <span class="st">"number_of_groups"</span>,
              p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">34.6</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_anova(data = ., x = strength, groups = batch, p = 0.99, </span>
<span class="co">#&gt;     conf = 0.95, override = "number_of_groups")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  ANOVA     ( n = 20, r = 3 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `number_of_groups`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 34.57763</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_anova</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span>, override <span class="op">=</span> <span class="st">"number_of_groups"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">63.2</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_anova(data = ., x = strength, groups = batch, override = "number_of_groups")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  ANOVA     ( n = 20, r = 3 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `number_of_groups`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 63.20276</span></code></pre></div>
</div>
</div>
<div id="dataset-from-section-8-3-11-1-2" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-from-section-8-3-11-1-2" class="anchor"></a>4.2 Dataset From Section 8.3.11.1.2</h2>
<p><span class="citation">[2]</span> provides an example data set and results from ASAP <span class="citation">[1]</span>. This example data set is duplicated below:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_8_3_11_1_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">batch</span>, <span class="op">~</span><span class="va">strength</span>, <span class="op">~</span><span class="va">condition</span>,
  <span class="fl">1</span>, <span class="fl">79.04517</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">103.2006</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">63.22764</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">54.09806</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">102.6014</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">105.1034</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">70.84454</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">58.87615</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">97.79372</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">105.1893</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">66.43223</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">61.60167</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">92.86423</span>, <span class="st">"CTD"</span>, <span class="fl">1</span>, <span class="fl">100.4189</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">75.37771</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">60.23973</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">117.218</span>,  <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">85.32319</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">72.43773</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">61.4808</span>,  <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">108.7168</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">92.69923</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">68.43073</span>, <span class="st">"ETW"</span>, <span class="fl">1</span>, <span class="fl">64.55832</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">112.2773</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">98.45242</span>, <span class="st">"RTD"</span>, <span class="fl">1</span>, <span class="fl">69.72524</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">57.76131</span>, <span class="st">"ETW2"</span>,
  <span class="fl">1</span>, <span class="fl">114.0129</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">104.1014</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">66.20343</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">49.91463</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">106.8452</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">91.51841</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">60.51251</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">61.49271</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">112.3911</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">101.3746</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">65.69334</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">57.7281</span>,  <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">115.5658</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">101.5828</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">62.73595</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">62.11653</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">87.40657</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">99.57384</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">59.00798</span>, <span class="st">"ETW"</span>, <span class="fl">2</span>, <span class="fl">62.69353</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">102.2785</span>, <span class="st">"CTD"</span>, <span class="fl">2</span>, <span class="fl">88.84826</span>, <span class="st">"RTD"</span>, <span class="fl">2</span>, <span class="fl">62.37761</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">61.38523</span>, <span class="st">"ETW2"</span>,
  <span class="fl">2</span>, <span class="fl">110.6073</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">92.18703</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">64.3947</span>,  <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">60.39053</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">105.2762</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">101.8234</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">72.8491</span>,  <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">59.17616</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">110.8924</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">97.68909</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">66.56226</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">60.17616</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">108.7638</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">101.5172</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">66.56779</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">46.47396</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">110.9833</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">100.0481</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">66.00123</span>, <span class="st">"ETW"</span>, <span class="fl">3</span>, <span class="fl">51.16616</span>, <span class="st">"ETW2"</span>,
  <span class="fl">3</span>, <span class="fl">101.3417</span>, <span class="st">"CTD"</span>, <span class="fl">3</span>, <span class="fl">102.0544</span>, <span class="st">"RTD"</span>, <span class="fl">3</span>, <span class="fl">59.62108</span>, <span class="st">"ETW"</span>,
  <span class="fl">3</span>, <span class="fl">100.0251</span>, <span class="st">"CTD"</span>,                     <span class="fl">3</span>, <span class="fl">60.61167</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">57.65487</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">66.51241</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">64.89347</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">57.73054</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">68.94086</span>, <span class="st">"ETW"</span>,
                                          <span class="fl">3</span>, <span class="fl">61.63177</span>, <span class="st">"ETW"</span>
<span class="op">)</span></code></pre></div>
<div id="c12-psd" class="section level3">
<h3 class="hasAnchor">
<a href="#c12-psd" class="anchor"></a>4.2.1 Pooled SD A- and B-Basis</h3>
<p>CMH-17-1G Table 8.3.11.2(k) provides outputs from ASAP for the data set above. ASAP uses the pooled SD method. ASAP produces the following results, which are quite similar to those produced by <code>cmstatr</code>.</p>
<table class="table">
<thead><tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
<th>ETW2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>93.64</td>
<td>87.30</td>
<td>54.33</td>
<td>47.12</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>89.19</td>
<td>79.86</td>
<td>46.84</td>
<td>39.69</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_pooled_sd</a></span><span class="op">(</span><span class="va">dat_8_3_11_1_2</span>, <span class="va">strength</span>, <span class="va">condition</span>,
                         override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
           <span class="fl">93.64</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
           <span class="fl">87.30</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
           <span class="fl">54.33</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">]</span>,
           <span class="fl">47.12</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_sd(data = dat_8_3_11_1_2, x = strength, groups = condition, </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 83, r = 4 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `pooled_variance_equal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; CTD   93.63504 </span>
<span class="co">#&gt; ETW   54.32706 </span>
<span class="co">#&gt; ETW2  47.07669 </span>
<span class="co">#&gt; RTD   87.29555</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_pooled_sd</a></span><span class="op">(</span><span class="va">dat_8_3_11_1_2</span>, <span class="va">strength</span>, <span class="va">condition</span>,
                       p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                       override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
           <span class="fl">86.19</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
           <span class="fl">79.86</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
           <span class="fl">46.84</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">]</span>,
           <span class="fl">39.69</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_sd(data = dat_8_3_11_1_2, x = strength, groups = condition, </span>
<span class="co">#&gt;     p = 0.99, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 83, r = 4 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `pooled_variance_equal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; CTD   86.19301 </span>
<span class="co">#&gt; ETW   46.84112 </span>
<span class="co">#&gt; ETW2  39.65214 </span>
<span class="co">#&gt; RTD   79.86205</span></code></pre></div>
</div>
<div id="c12-psdmcv" class="section level3">
<h3 class="hasAnchor">
<a href="#c12-psdmcv" class="anchor"></a>4.2.2 Pooled SD A- and B-Basis (Mod CV)</h3>
<p>After removal of the ETW2 condition, CMH17-STATS reports the pooled A- and B-Basis (mod CV) shown in the following table. <code>cmstatr</code> computes very similar values.</p>
<table class="table">
<thead><tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>92.25</td>
<td>85.91</td>
<td>52.97</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>83.81</td>
<td>77.48</td>
<td>44.47</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_pooled_sd</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">92.25</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">85.91</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">52.97</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_sd(data = ., x = strength, groups = condition, modcv = TRUE, </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 65, r = 3 )</span>
<span class="co">#&gt; Modified CV Approach Used </span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `pooled_variance_equal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; CTD  92.24927 </span>
<span class="co">#&gt; ETW  52.9649 </span>
<span class="co">#&gt; RTD  85.90454</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_pooled_sd</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span>,
                  p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">83.81</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">77.48</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">44.47</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_sd(data = ., x = strength, groups = condition, p = 0.99, </span>
<span class="co">#&gt;     conf = 0.95, modcv = TRUE, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 65, r = 3 )</span>
<span class="co">#&gt; Modified CV Approach Used </span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `pooled_variance_equal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; CTD  83.80981 </span>
<span class="co">#&gt; ETW  44.47038 </span>
<span class="co">#&gt; RTD  77.47589</span></code></pre></div>
</div>
<div id="c12-pcv" class="section level3">
<h3 class="hasAnchor">
<a href="#c12-pcv" class="anchor"></a>4.2.3 Pooled CV A- and B-Basis</h3>
<p>This data set was input into CMH17-STATS and the Pooled CV method was selected. The results from CMH17-STATS were as follows. <code>cmstatr</code> produces very similar results.</p>
<table class="table">
<thead><tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
<th>ETW2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>90.89</td>
<td>85.37</td>
<td>56.79</td>
<td>50.55</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>81.62</td>
<td>76.67</td>
<td>50.98</td>
<td>45.40</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_pooled_cv</a></span><span class="op">(</span><span class="va">dat_8_3_11_1_2</span>, <span class="va">strength</span>, <span class="va">condition</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">90.89</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">85.37</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">56.79</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">]</span>,
             <span class="fl">50.55</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_cv(data = dat_8_3_11_1_2, x = strength, groups = condition, </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 83, r = 4 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `normalized_variance_equal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; CTD   90.88018 </span>
<span class="co">#&gt; ETW   56.78337 </span>
<span class="co">#&gt; ETW2  50.54406 </span>
<span class="co">#&gt; RTD   85.36756</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_pooled_cv</a></span><span class="op">(</span><span class="va">dat_8_3_11_1_2</span>, <span class="va">strength</span>, <span class="va">condition</span>,
                       p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">81.62</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">76.67</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">50.98</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW2"</span><span class="op">]</span>,
             <span class="fl">45.40</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_cv(data = dat_8_3_11_1_2, x = strength, groups = condition, </span>
<span class="co">#&gt;     p = 0.99, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 83, r = 4 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `normalized_variance_equal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; CTD   81.60931 </span>
<span class="co">#&gt; ETW   50.97801 </span>
<span class="co">#&gt; ETW2  45.39158 </span>
<span class="co">#&gt; RTD   76.66214</span></code></pre></div>
</div>
<div id="c12-pcvmcv" class="section level3">
<h3 class="hasAnchor">
<a href="#c12-pcvmcv" class="anchor"></a>4.2.4 Pooled CV A- and B-Basis (Mod CV)</h3>
<p>This data set was input into CMH17-STATS and the Pooled CV method was selected with the modified CV transform. Additionally, the ETW2 condition was removed. The results from CMH17-STATS were as follows. <code>cmstatr</code> produces very similar results.</p>
<table class="table">
<thead><tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>90.31</td>
<td>84.83</td>
<td>56.43</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>80.57</td>
<td>75.69</td>
<td>50.33</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_pooled_cv</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">90.31</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">84.83</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">56.43</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_cv(data = ., x = strength, groups = condition, modcv = TRUE, </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 65, r = 3 )</span>
<span class="co">#&gt; Modified CV Approach Used </span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `normalized_variance_equal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; CTD  90.30646 </span>
<span class="co">#&gt; ETW  56.42786 </span>
<span class="co">#&gt; RTD  84.82748</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">dat_8_3_11_1_2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">!=</span> <span class="st">"ETW2"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/basis.html">basis_pooled_cv</a></span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span>,
                  p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"CTD"</span><span class="op">]</span>,
             <span class="fl">80.57</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">]</span>,
             <span class="fl">75.69</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ETW"</span><span class="op">]</span>,
             <span class="fl">50.33</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_pooled_cv(data = ., x = strength, groups = condition, p = 0.99, </span>
<span class="co">#&gt;     conf = 0.95, modcv = TRUE, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 65, r = 3 )</span>
<span class="co">#&gt; Modified CV Approach Used </span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_group_variability`,</span>
<span class="co">#&gt;     `outliers_within_group`,</span>
<span class="co">#&gt;     `pooled_data_normal`,</span>
<span class="co">#&gt;     `normalized_variance_equal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; CTD  80.56529 </span>
<span class="co">#&gt; ETW  50.32422 </span>
<span class="co">#&gt; RTD  75.6817</span></code></pre></div>
</div>
</div>
</div>
<div id="other-data-sets" class="section level1">
<h1 class="hasAnchor">
<a href="#other-data-sets" class="anchor"></a>5. Other Data Sets</h1>
<p>This section contains various small data sets. In most cases, these data sets were generated randomly for the purpose of comparing <code>cmstatr</code> to other software.</p>
<div id="ods-adn" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-adn" class="anchor"></a>5.1 Anderson–Darling Test (Normal)</h2>
<p>The following data set was randomly generated. When this is entered into STAT17 <span class="citation">[3]</span>, that software gives the value <span class="math inline">\(OSL = 0.465\)</span>, which matches the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  strength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,
    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_normal</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">strength</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.465</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_normal(data = dat, x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal ( n = 18 ) </span>
<span class="co">#&gt; Test statistic:  A = 0.2849726 </span>
<span class="co">#&gt; OSL (p-value):  0.4648132  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is drawn from a Normal distribution ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="ods-adl" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-adl" class="anchor"></a>5.2 Anderson–Darling Test (Lognormal)</h2>
<p>The following data set was randomly generated. When this is entered into STAT17 <span class="citation">[3]</span>, that software gives the value <span class="math inline">\(OSL = 0.480\)</span>, which matches the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  strength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,
    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_lognormal</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">strength</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.480</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_lognormal(data = dat, x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Lognormal ( n = 18 ) </span>
<span class="co">#&gt; Test statistic:  A = 0.2774652 </span>
<span class="co">#&gt; OSL (p-value):  0.4798148  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is drawn from a Lognormal distribution ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="ods-adw" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-adw" class="anchor"></a>5.3 Anderson–Darling Test (Weibull)</h2>
<p>The following data set was randomly generated. When this is entered into STAT17 <span class="citation">[3]</span>, that software gives the value <span class="math inline">\(OSL = 0.179\)</span>, which matches the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  strength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,
    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anderson_darling.html">anderson_darling_weibull</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">strength</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">osl</span>, <span class="fl">0.179</span>, tolerance <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; anderson_darling_weibull(data = dat, x = strength)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Weibull ( n = 18 ) </span>
<span class="co">#&gt; Test statistic:  A = 0.5113909 </span>
<span class="co">#&gt; OSL (p-value):  0.1787882  (assuming unknown parameters)</span>
<span class="co">#&gt; Conclusion: Sample is drawn from a Weibull distribution ( alpha = 0.05 )</span></code></pre></div>
</div>
<div id="ods-nb" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-nb" class="anchor"></a>5.4 Normal A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis values were computed assuming normally distributed data. The results were 120.336 and 129.287, respectively. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,
  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_normal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">120.336</span>, tolerance <span class="op">=</span> <span class="fl">0.0005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_normal(x = dat, p = 0.99, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal    ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_normal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 120.3549</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_normal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">129.287</span>, tolerance <span class="op">=</span> <span class="fl">0.0005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_normal(x = dat, p = 0.9, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Normal    ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_normal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 129.2898</span></code></pre></div>
</div>
<div id="ods-lb" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-lb" class="anchor"></a>5.5 Lognormal A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis values were computed assuming distributed according to a lognormal distribution. The results were 121.710 and 129.664, respectively. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,
  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_lognormal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">121.710</span>, tolerance <span class="op">=</span> <span class="fl">0.0005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_lognormal(x = dat, p = 0.99, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Lognormal     ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_lognormal`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 121.7265</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_lognormal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">129.664</span>, tolerance <span class="op">=</span> <span class="fl">0.0005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_lognormal(x = dat, p = 0.9, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Lognormal     ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_lognormal`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 129.667</span></code></pre></div>
</div>
<div id="ods-wb" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-wb" class="anchor"></a>5.6 Weibull A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis values were computed assuming data following the Weibull distribution. The results were 109.150 and 125.441, respectively. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,
  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_weibull</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">109.150</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_weibull(x = dat, p = 0.99, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Weibull   ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_weibull`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 109.651</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_weibull</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">125.441</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_weibull(x = dat, p = 0.9, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Weibull   ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `anderson_darling_weibull`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 125.7338</span></code></pre></div>
</div>
<div id="ods-hkb" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-hkb" class="anchor"></a>5.7 Extended Hanson–Koopmans A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis values were computed using the nonparametric (small sample) method. The results were 99.651 and 124.156, respectively. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,
  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,
  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                    method <span class="op">=</span> <span class="st">"woodward-frawley"</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">99.651</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(x = dat, p = 0.99, conf = 0.95, method = "woodward-frawley", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, Woodward-Frawley method)     ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span>
<span class="co">#&gt; 99.65098</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                    method <span class="op">=</span> <span class="st">"optimum-order"</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">124.156</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(x = dat, p = 0.9, conf = 0.95, method = "optimum-order", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 18 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 124.1615</span></code></pre></div>
</div>
<div id="ods-hkb2" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-hkb2" class="anchor"></a>5.8 Extended Hanson–Koopmans B-Basis</h2>
<p>The following random numbers were generated.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">139.6734</span>, <span class="fl">143.0032</span>, <span class="fl">130.4757</span>, <span class="fl">144.8327</span>, <span class="fl">138.7818</span>, <span class="fl">136.7693</span>, <span class="fl">148.636</span>,
  <span class="fl">131.0095</span>, <span class="fl">131.4933</span>, <span class="fl">142.8856</span>, <span class="fl">158.0198</span>, <span class="fl">145.2271</span>, <span class="fl">137.5991</span>, <span class="fl">139.8298</span>,
  <span class="fl">140.8557</span>, <span class="fl">137.6148</span>, <span class="fl">131.3614</span>, <span class="fl">152.7795</span>, <span class="fl">145.8792</span>, <span class="fl">152.9207</span>, <span class="fl">160.0989</span>,
  <span class="fl">145.1920</span>, <span class="fl">128.6383</span>, <span class="fl">141.5992</span>, <span class="fl">122.5297</span>, <span class="fl">159.8209</span>, <span class="fl">151.6720</span>, <span class="fl">159.0156</span>
<span class="op">)</span></code></pre></div>
<p>All of the numbers above were input into STAT17 and the reported B-Basis value using the Optimum Order nonparametric method was 122.36798. This result matches the results of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                    method <span class="op">=</span> <span class="st">"optimum-order"</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">122.36798</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(x = dat, p = 0.9, conf = 0.95, method = "optimum-order", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 28 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 122.3638</span></code></pre></div>
<p>The last two observations from the above data set were discarded, leaving 26 observations. This smaller data set was input into STAT17 and that software calculated a B-Basis value of 121.57073 using the Optimum Order nonparametric method. <code>cmstatr</code> reports a very similar number.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">26</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                    method <span class="op">=</span> <span class="st">"optimum-order"</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">121.57073</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(x = head(dat, 26), p = 0.9, conf = 0.95, method = "optimum-order", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 26 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 121.5655</span></code></pre></div>
<p>The same data set was further reduced such that only the first 22 observations were included. This smaller data set was input into STAT17 and that software calculated a B-Basis value of 128.82397 using the Optimum Order nonparametric method. <code>cmstatr</code> reports a very similar number.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_hk_ext</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">22</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                    method <span class="op">=</span> <span class="st">"optimum-order"</span>, override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">128.82397</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_hk_ext(x = head(dat, 22), p = 0.9, conf = 0.95, method = "optimum-order", </span>
<span class="co">#&gt;     override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 22 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `correct_method_used`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 128.8224</span></code></pre></div>
</div>
<div id="ods-lsnb" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-lsnb" class="anchor"></a>5.9 Large Sample Nonparametric B-Basis</h2>
<p>The following data was input into STAT17 and the B-Basis value was computed using the nonparametric (large sample) method. The results was 122.738297. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fl">137.3603</span>, <span class="fl">135.6665</span>, <span class="fl">136.6914</span>, <span class="fl">154.7919</span>, <span class="fl">159.2037</span>, <span class="fl">137.3277</span>, <span class="fl">128.821</span>,
  <span class="fl">138.6304</span>, <span class="fl">138.9004</span>, <span class="fl">147.4598</span>, <span class="fl">148.6622</span>, <span class="fl">144.4948</span>, <span class="fl">131.0851</span>, <span class="fl">149.0203</span>,
  <span class="fl">131.8232</span>, <span class="fl">146.4471</span>, <span class="fl">123.8124</span>, <span class="fl">126.3105</span>, <span class="fl">140.7609</span>, <span class="fl">134.4875</span>, <span class="fl">128.7508</span>,
  <span class="fl">117.1854</span>, <span class="fl">129.3088</span>, <span class="fl">141.6789</span>, <span class="fl">138.4073</span>, <span class="fl">136.0295</span>, <span class="fl">128.4164</span>, <span class="fl">141.7733</span>,
  <span class="fl">134.455</span>,  <span class="fl">122.7383</span>, <span class="fl">136.9171</span>, <span class="fl">136.9232</span>, <span class="fl">138.8402</span>, <span class="fl">152.8294</span>, <span class="fl">135.0633</span>,
  <span class="fl">121.052</span>,  <span class="fl">131.035</span>,  <span class="fl">138.3248</span>, <span class="fl">131.1379</span>, <span class="fl">147.3771</span>, <span class="fl">130.0681</span>, <span class="fl">132.7467</span>,
  <span class="fl">137.1444</span>, <span class="fl">141.662</span>,  <span class="fl">146.9363</span>, <span class="fl">160.7448</span>, <span class="fl">138.5511</span>, <span class="fl">129.1628</span>, <span class="fl">140.2939</span>,
  <span class="fl">144.8167</span>, <span class="fl">156.5918</span>, <span class="fl">132.0099</span>, <span class="fl">129.3551</span>, <span class="fl">136.6066</span>, <span class="fl">134.5095</span>, <span class="fl">128.2081</span>,
  <span class="fl">144.0896</span>, <span class="fl">141.8029</span>, <span class="fl">130.0149</span>, <span class="fl">140.8813</span>, <span class="fl">137.7864</span>
<span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basis.html">basis_nonpara_large_sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>,
                                  override <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">basis</span>, <span class="fl">122.738297</span>, tolerance <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; basis_nonpara_large_sample(x = dat, p = 0.9, conf = 0.95, override = "all")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution:  Nonparametric (large sample)  ( n = 61 )</span>
<span class="co">#&gt; The following diagnostic tests were overridden:</span>
<span class="co">#&gt;     `outliers_within_batch`,</span>
<span class="co">#&gt;     `between_batch_variability`,</span>
<span class="co">#&gt;     `outliers`,</span>
<span class="co">#&gt;     `sample_size`</span>
<span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="co">#&gt; 122.7383</span></code></pre></div>
</div>
<div id="ods-eme" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-eme" class="anchor"></a>5.10 Acceptance Limits Based on Mean and Extremum</h2>
<p>Results from <code>cmstatr</code>’s <code>equiv_mean_extremum</code> function were compared with results from HYTEQ. The summary statistics for the qualification data were set as <code>mean = 141.310</code> and <code>sd=6.415</code>. For a value of <code>alpha=0.05</code> and <code>n = 9</code>, HYTEQ reported thresholds of 123.725 and 137.197 for minimum individual and mean, respectively. <code>cmstatr</code> produces very similar results.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equiv_mean_extremum.html">equiv_mean_extremum</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, mean_qual <span class="op">=</span> <span class="fl">141.310</span>, sd_qual <span class="op">=</span> <span class="fl">6.415</span>,
                           n_sample <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold_min_indiv</span>, <span class="fl">123.725</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold_mean</span>, <span class="fl">137.197</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; equiv_mean_extremum(mean_qual = 141.31, sd_qual = 6.415, n_sample = 9, </span>
<span class="co">#&gt;     alpha = 0.05)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For alpha = 0.05 and n = 9 </span>
<span class="co">#&gt; ( k1 = 2.741054 and k2 = 0.6410852 )</span>
<span class="co">#&gt;                   Min Individual    Sample Mean    </span>
<span class="co">#&gt;      Thresholds:     123.7261         137.1974</span></code></pre></div>
<p>Using the same parameters, but using the modified CV method, HYTEQ produces thresholds of 117.024 and 135.630 for minimum individual and mean, respectively. <code>cmstatr</code> produces very similar results.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equiv_mean_extremum.html">equiv_mean_extremum</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, mean_qual <span class="op">=</span> <span class="fl">141.310</span>, sd_qual <span class="op">=</span> <span class="fl">6.415</span>,
                           n_sample <span class="op">=</span> <span class="fl">9</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold_min_indiv</span>, <span class="fl">117.024</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold_mean</span>, <span class="fl">135.630</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; equiv_mean_extremum(mean_qual = 141.31, sd_qual = 6.415, n_sample = 9, </span>
<span class="co">#&gt;     alpha = 0.05, modcv = TRUE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Modified CV used: CV* = 0.06269832 ( CV = 0.04539665 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For alpha = 0.05 and n = 9 </span>
<span class="co">#&gt; ( k1 = 2.741054 and k2 = 0.6410852 )</span>
<span class="co">#&gt;                   Min Individual    Sample Mean    </span>
<span class="co">#&gt;      Thresholds:     117.0245          135.63</span></code></pre></div>
</div>
<div id="ods-ecm" class="section level2">
<h2 class="hasAnchor">
<a href="#ods-ecm" class="anchor"></a>5.11 Acceptance Based on Change in Mean</h2>
<p>Results from <code>cmstatr</code>’s <code>equiv_change_mean</code> function were compared with results from HYTEQ. The following parameters were used. A value of <code>alpha = 0.05</code> was selected.</p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Qualification</th>
<th>Sample</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>9.24</td>
<td>9.02</td>
</tr>
<tr class="even">
<td>SD</td>
<td>0.162</td>
<td>0.15785</td>
</tr>
<tr class="odd">
<td>n</td>
<td>28</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>HYTEQ gives an acceptance range of 9.115 to 9.365. <code>cmstatr</code> produces similar results.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equiv_change_mean.html">equiv_change_mean</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, n_sample <span class="op">=</span> <span class="fl">9</span>, mean_sample <span class="op">=</span> <span class="fl">9.02</span>,
                         sd_sample <span class="op">=</span> <span class="fl">0.15785</span>, n_qual <span class="op">=</span> <span class="fl">28</span>, mean_qual <span class="op">=</span> <span class="fl">9.24</span>,
                         sd_qual <span class="op">=</span> <span class="fl">0.162</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9.115</span>, <span class="fl">9.365</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; equiv_change_mean(n_qual = 28, mean_qual = 9.24, sd_qual = 0.162, </span>
<span class="co">#&gt;     n_sample = 9, mean_sample = 9.02, sd_sample = 0.15785, alpha = 0.05)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For alpha = 0.05 </span>
<span class="co">#&gt;                   Qualification        Sample      </span>
<span class="co">#&gt;           Number        28               9         </span>
<span class="co">#&gt;             Mean       9.24             9.02       </span>
<span class="co">#&gt;               SD      0.162           0.15785      </span>
<span class="co">#&gt;           Result               FAIL               </span>
<span class="co">#&gt;    Passing Range       9.114712 to 9.365288</span></code></pre></div>
<p>After selecting the modified CV method, HYTEQ gives an acceptance range of 8.857 to 9.623. <code>cmstatr</code> produces similar results.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equiv_change_mean.html">equiv_change_mean</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, n_sample <span class="op">=</span> <span class="fl">9</span>, mean_sample <span class="op">=</span> <span class="fl">9.02</span>,
                         sd_sample <span class="op">=</span> <span class="fl">0.15785</span>, n_qual <span class="op">=</span> <span class="fl">28</span>, mean_qual <span class="op">=</span> <span class="fl">9.24</span>,
                         sd_qual <span class="op">=</span> <span class="fl">0.162</span>, modcv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">threshold</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.857</span>, <span class="fl">9.623</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; equiv_change_mean(n_qual = 28, mean_qual = 9.24, sd_qual = 0.162, </span>
<span class="co">#&gt;     n_sample = 9, mean_sample = 9.02, sd_sample = 0.15785, alpha = 0.05, </span>
<span class="co">#&gt;     modcv = TRUE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For alpha = 0.05 </span>
<span class="co">#&gt; Modified CV used</span>
<span class="co">#&gt;                   Qualification        Sample      </span>
<span class="co">#&gt;           Number        28               9         </span>
<span class="co">#&gt;             Mean       9.24             9.02       </span>
<span class="co">#&gt;               SD      0.162           0.15785      </span>
<span class="co">#&gt;           Result               PASS               </span>
<span class="co">#&gt;    Passing Range       8.856695 to 9.623305</span></code></pre></div>
</div>
</div>
<div id="comparison-with-literature" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-literature" class="anchor"></a>6. Comparison with Literature</h1>
<p>In this section, results from <code>cmstatr</code> are compared with values published in literature.</p>
<div id="cl-adk" class="section level2">
<h2 class="hasAnchor">
<a href="#cl-adk" class="anchor"></a>6.1 Anderson–Darling K–Sample Test</h2>
<p><span class="citation">[4]</span> provides example data that compares measurements obtained in four labs. Their paper gives values of the ADK test statistic as well as p-values.</p>
<p>The data in <span class="citation">[4]</span> is as follows:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_ss1987</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  smoothness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">38.7</span>, <span class="fl">41.5</span>, <span class="fl">43.8</span>, <span class="fl">44.5</span>, <span class="fl">45.5</span>, <span class="fl">46.0</span>, <span class="fl">47.7</span>, <span class="fl">58.0</span>,
    <span class="fl">39.2</span>, <span class="fl">39.3</span>, <span class="fl">39.7</span>, <span class="fl">41.4</span>, <span class="fl">41.8</span>, <span class="fl">42.9</span>, <span class="fl">43.3</span>, <span class="fl">45.8</span>,
    <span class="fl">34.0</span>, <span class="fl">35.0</span>, <span class="fl">39.0</span>, <span class="fl">40.0</span>, <span class="fl">43.0</span>, <span class="fl">43.0</span>, <span class="fl">44.0</span>, <span class="fl">45.0</span>,
    <span class="fl">34.0</span>, <span class="fl">34.8</span>, <span class="fl">34.8</span>, <span class="fl">35.4</span>, <span class="fl">37.2</span>, <span class="fl">37.8</span>, <span class="fl">41.2</span>, <span class="fl">42.8</span>
  <span class="op">)</span>,
  lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dat_ss1987</span>
<span class="co">#&gt;    smoothness lab</span>
<span class="co">#&gt; 1        38.7   A</span>
<span class="co">#&gt; 2        41.5   A</span>
<span class="co">#&gt; 3        43.8   A</span>
<span class="co">#&gt; 4        44.5   A</span>
<span class="co">#&gt; 5        45.5   A</span>
<span class="co">#&gt; 6        46.0   A</span>
<span class="co">#&gt; 7        47.7   A</span>
<span class="co">#&gt; 8        58.0   A</span>
<span class="co">#&gt; 9        39.2   B</span>
<span class="co">#&gt; 10       39.3   B</span>
<span class="co">#&gt; 11       39.7   B</span>
<span class="co">#&gt; 12       41.4   B</span>
<span class="co">#&gt; 13       41.8   B</span>
<span class="co">#&gt; 14       42.9   B</span>
<span class="co">#&gt; 15       43.3   B</span>
<span class="co">#&gt; 16       45.8   B</span>
<span class="co">#&gt; 17       34.0   C</span>
<span class="co">#&gt; 18       35.0   C</span>
<span class="co">#&gt; 19       39.0   C</span>
<span class="co">#&gt; 20       40.0   C</span>
<span class="co">#&gt; 21       43.0   C</span>
<span class="co">#&gt; 22       43.0   C</span>
<span class="co">#&gt; 23       44.0   C</span>
<span class="co">#&gt; 24       45.0   C</span>
<span class="co">#&gt; 25       34.0   D</span>
<span class="co">#&gt; 26       34.8   D</span>
<span class="co">#&gt; 27       34.8   D</span>
<span class="co">#&gt; 28       35.4   D</span>
<span class="co">#&gt; 29       37.2   D</span>
<span class="co">#&gt; 30       37.8   D</span>
<span class="co">#&gt; 31       41.2   D</span>
<span class="co">#&gt; 32       42.8   D</span></code></pre></div>
<p><span class="citation">[4]</span> lists the corresponding test statistics <span class="math inline">\(A_{akN}^2 = 8.3926\)</span> and <span class="math inline">\(\sigma_N = 1.2038\)</span> with the p-value <span class="math inline">\(p = 0.0022\)</span>. These match the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ad_ksample.html">ad_ksample</a></span><span class="op">(</span><span class="va">dat_ss1987</span>, <span class="va">smoothness</span>, <span class="va">lab</span><span class="op">)</span>

<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ad</span>, <span class="fl">8.3926</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">1.2038</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">p</span>, <span class="fl">0.00226</span>, tolerance <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>

<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ad_ksample(data = dat_ss1987, x = smoothness, groups = lab)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 32           k = 4            </span>
<span class="co">#&gt; ADK = 8.39       p-value = 0.002255 </span>
<span class="co">#&gt; Conclusion: Samples do not come from the same distribution (alpha = 0.025 )</span></code></pre></div>
</div>
</div>
<div id="comparison-with-published-factors" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-published-factors" class="anchor"></a>7. Comparison with Published Factors</h1>
<p>Various factors, such as tolerance limit factors, are published in various publications. This section compares those published factors with those computed by <code>cmstatr</code>.</p>
<div id="pf-kb" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-kb" class="anchor"></a>7.1 Normal kB Factors</h2>
<p>B-Basis tolerance limit factors assuming a normal distribution are published in CMH-17-1G. Those factors are reproduced below and are compared with the results of <code>cmstatr</code>. The published factors and those computed by <code>cmstatr</code> are quite similar.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">kB_published</span>,
  <span class="fl">2</span>, <span class="fl">20.581</span>, <span class="fl">36</span>, <span class="fl">1.725</span>, <span class="fl">70</span>, <span class="fl">1.582</span>, <span class="fl">104</span>, <span class="fl">1.522</span>,
  <span class="fl">3</span>, <span class="fl">6.157</span>, <span class="fl">37</span>, <span class="fl">1.718</span>, <span class="fl">71</span>, <span class="fl">1.579</span>, <span class="fl">105</span>, <span class="fl">1.521</span>,
  <span class="fl">4</span>, <span class="fl">4.163</span>, <span class="fl">38</span>, <span class="fl">1.711</span>, <span class="fl">72</span>, <span class="fl">1.577</span>, <span class="fl">106</span>, <span class="fl">1.519</span>,
  <span class="fl">5</span>, <span class="fl">3.408</span>, <span class="fl">39</span>, <span class="fl">1.704</span>, <span class="fl">73</span>, <span class="fl">1.575</span>, <span class="fl">107</span>, <span class="fl">1.518</span>,
  <span class="fl">6</span>, <span class="fl">3.007</span>, <span class="fl">40</span>, <span class="fl">1.698</span>, <span class="fl">74</span>, <span class="fl">1.572</span>, <span class="fl">108</span>, <span class="fl">1.517</span>,
  <span class="fl">7</span>, <span class="fl">2.756</span>, <span class="fl">41</span>, <span class="fl">1.692</span>, <span class="fl">75</span>, <span class="fl">1.570</span>, <span class="fl">109</span>, <span class="fl">1.516</span>,
  <span class="fl">8</span>, <span class="fl">2.583</span>, <span class="fl">42</span>, <span class="fl">1.686</span>, <span class="fl">76</span>, <span class="fl">1.568</span>, <span class="fl">110</span>, <span class="fl">1.515</span>,
  <span class="fl">9</span>, <span class="fl">2.454</span>, <span class="fl">43</span>, <span class="fl">1.680</span>, <span class="fl">77</span>, <span class="fl">1.566</span>, <span class="fl">111</span>, <span class="fl">1.513</span>,
  <span class="fl">10</span>, <span class="fl">2.355</span>, <span class="fl">44</span>, <span class="fl">1.675</span>, <span class="fl">78</span>, <span class="fl">1.564</span>, <span class="fl">112</span>, <span class="fl">1.512</span>,
  <span class="fl">11</span>, <span class="fl">2.276</span>, <span class="fl">45</span>, <span class="fl">1.669</span>, <span class="fl">79</span>, <span class="fl">1.562</span>, <span class="fl">113</span>, <span class="fl">1.511</span>,
  <span class="fl">12</span>, <span class="fl">2.211</span>, <span class="fl">46</span>, <span class="fl">1.664</span>, <span class="fl">80</span>, <span class="fl">1.560</span>, <span class="fl">114</span>, <span class="fl">1.510</span>,
  <span class="fl">13</span>, <span class="fl">2.156</span>, <span class="fl">47</span>, <span class="fl">1.660</span>, <span class="fl">81</span>, <span class="fl">1.558</span>, <span class="fl">115</span>, <span class="fl">1.509</span>,
  <span class="fl">14</span>, <span class="fl">2.109</span>, <span class="fl">48</span>, <span class="fl">1.655</span>, <span class="fl">82</span>, <span class="fl">1.556</span>, <span class="fl">116</span>, <span class="fl">1.508</span>,
  <span class="fl">15</span>, <span class="fl">2.069</span>, <span class="fl">49</span>, <span class="fl">1.650</span>, <span class="fl">83</span>, <span class="fl">1.554</span>, <span class="fl">117</span>, <span class="fl">1.507</span>,
  <span class="fl">16</span>, <span class="fl">2.034</span>, <span class="fl">50</span>, <span class="fl">1.646</span>, <span class="fl">84</span>, <span class="fl">1.552</span>, <span class="fl">118</span>, <span class="fl">1.506</span>,
  <span class="fl">17</span>, <span class="fl">2.002</span>, <span class="fl">51</span>, <span class="fl">1.642</span>, <span class="fl">85</span>, <span class="fl">1.551</span>, <span class="fl">119</span>, <span class="fl">1.505</span>,
  <span class="fl">18</span>, <span class="fl">1.974</span>, <span class="fl">52</span>, <span class="fl">1.638</span>, <span class="fl">86</span>, <span class="fl">1.549</span>, <span class="fl">120</span>, <span class="fl">1.504</span>,
  <span class="fl">19</span>, <span class="fl">1.949</span>, <span class="fl">53</span>, <span class="fl">1.634</span>, <span class="fl">87</span>, <span class="fl">1.547</span>, <span class="fl">121</span>, <span class="fl">1.503</span>,
  <span class="fl">20</span>, <span class="fl">1.927</span>, <span class="fl">54</span>, <span class="fl">1.630</span>, <span class="fl">88</span>, <span class="fl">1.545</span>, <span class="fl">122</span>, <span class="fl">1.502</span>,
  <span class="fl">21</span>, <span class="fl">1.906</span>, <span class="fl">55</span>, <span class="fl">1.626</span>, <span class="fl">89</span>, <span class="fl">1.544</span>, <span class="fl">123</span>, <span class="fl">1.501</span>,
  <span class="fl">22</span>, <span class="fl">1.887</span>, <span class="fl">56</span>, <span class="fl">1.623</span>, <span class="fl">90</span>, <span class="fl">1.542</span>, <span class="fl">124</span>, <span class="fl">1.500</span>,
  <span class="fl">23</span>, <span class="fl">1.870</span>, <span class="fl">57</span>, <span class="fl">1.619</span>, <span class="fl">91</span>, <span class="fl">1.540</span>, <span class="fl">125</span>, <span class="fl">1.499</span>,
  <span class="fl">24</span>, <span class="fl">1.854</span>, <span class="fl">58</span>, <span class="fl">1.616</span>, <span class="fl">92</span>, <span class="fl">1.539</span>, <span class="fl">126</span>, <span class="fl">1.498</span>,
  <span class="fl">25</span>, <span class="fl">1.839</span>, <span class="fl">59</span>, <span class="fl">1.613</span>, <span class="fl">93</span>, <span class="fl">1.537</span>, <span class="fl">127</span>, <span class="fl">1.497</span>,
  <span class="fl">26</span>, <span class="fl">1.825</span>, <span class="fl">60</span>, <span class="fl">1.609</span>, <span class="fl">94</span>, <span class="fl">1.536</span>, <span class="fl">128</span>, <span class="fl">1.496</span>,
  <span class="fl">27</span>, <span class="fl">1.812</span>, <span class="fl">61</span>, <span class="fl">1.606</span>, <span class="fl">95</span>, <span class="fl">1.534</span>, <span class="fl">129</span>, <span class="fl">1.495</span>,
  <span class="fl">28</span>, <span class="fl">1.800</span>, <span class="fl">62</span>, <span class="fl">1.603</span>, <span class="fl">96</span>, <span class="fl">1.533</span>, <span class="fl">130</span>, <span class="fl">1.494</span>,
  <span class="fl">29</span>, <span class="fl">1.789</span>, <span class="fl">63</span>, <span class="fl">1.600</span>, <span class="fl">97</span>, <span class="fl">1.531</span>, <span class="fl">131</span>, <span class="fl">1.493</span>,
  <span class="fl">30</span>, <span class="fl">1.778</span>, <span class="fl">64</span>, <span class="fl">1.597</span>, <span class="fl">98</span>, <span class="fl">1.530</span>, <span class="fl">132</span>, <span class="fl">1.492</span>,
  <span class="fl">31</span>, <span class="fl">1.768</span>, <span class="fl">65</span>, <span class="fl">1.595</span>, <span class="fl">99</span>, <span class="fl">1.529</span>, <span class="fl">133</span>, <span class="fl">1.492</span>,
  <span class="fl">32</span>, <span class="fl">1.758</span>, <span class="fl">66</span>, <span class="fl">1.592</span>, <span class="fl">100</span>, <span class="fl">1.527</span>, <span class="fl">134</span>, <span class="fl">1.491</span>,
  <span class="fl">33</span>, <span class="fl">1.749</span>, <span class="fl">67</span>, <span class="fl">1.589</span>, <span class="fl">101</span>, <span class="fl">1.526</span>, <span class="fl">135</span>, <span class="fl">1.490</span>,
  <span class="fl">34</span>, <span class="fl">1.741</span>, <span class="fl">68</span>, <span class="fl">1.587</span>, <span class="fl">102</span>, <span class="fl">1.525</span>, <span class="fl">136</span>, <span class="fl">1.489</span>,
  <span class="fl">35</span>, <span class="fl">1.733</span>, <span class="fl">69</span>, <span class="fl">1.584</span>, <span class="fl">103</span>, <span class="fl">1.523</span>, <span class="fl">137</span>, <span class="fl">1.488</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>kB_cmstatr <span class="op">=</span> <span class="fu"><a href="../reference/k_factor_normal.html">k_factor_normal</a></span><span class="op">(</span><span class="va">n</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">kB_published</span>, <span class="va">kB_cmstatr</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 136 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n kB_published kB_cmstatr</span>
<span class="co">#&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1     2        20.6       20.6 </span>
<span class="co">#&gt;  2     3         6.16       6.16</span>
<span class="co">#&gt;  3     4         4.16       4.16</span>
<span class="co">#&gt;  4     5         3.41       3.41</span>
<span class="co">#&gt;  5     6         3.01       3.01</span>
<span class="co">#&gt;  6     7         2.76       2.76</span>
<span class="co">#&gt;  7     8         2.58       2.58</span>
<span class="co">#&gt;  8     9         2.45       2.45</span>
<span class="co">#&gt;  9    10         2.36       2.35</span>
<span class="co">#&gt; 10    11         2.28       2.28</span>
<span class="co">#&gt; # … with 126 more rows</span></code></pre></div>
</div>
<div id="pf-ka" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-ka" class="anchor"></a>7.2 Normal kA Factors</h2>
<p>A-Basis tolerance limit factors assuming a normal distribution are published in CMH-17-1G. Those factors are reproduced below and are compared with the results of <code>cmstatr</code>. The published factors and those computed by <code>cmstatr</code> are quite similar.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">kA_published</span>,
  <span class="fl">2</span>, <span class="fl">37.094</span>, <span class="fl">36</span>, <span class="fl">2.983</span>, <span class="fl">70</span>, <span class="fl">2.765</span>, <span class="fl">104</span>, <span class="fl">2.676</span>,
  <span class="fl">3</span>, <span class="fl">10.553</span>, <span class="fl">37</span>, <span class="fl">2.972</span>, <span class="fl">71</span>, <span class="fl">2.762</span>, <span class="fl">105</span>, <span class="fl">2.674</span>,
  <span class="fl">4</span>, <span class="fl">7.042</span>, <span class="fl">38</span>, <span class="fl">2.961</span>, <span class="fl">72</span>, <span class="fl">2.758</span>, <span class="fl">106</span>, <span class="fl">2.672</span>,
  <span class="fl">5</span>, <span class="fl">5.741</span>, <span class="fl">39</span>, <span class="fl">2.951</span>, <span class="fl">73</span>, <span class="fl">2.755</span>, <span class="fl">107</span>, <span class="fl">2.671</span>,
  <span class="fl">6</span>, <span class="fl">5.062</span>, <span class="fl">40</span>, <span class="fl">2.941</span>, <span class="fl">74</span>, <span class="fl">2.751</span>, <span class="fl">108</span>, <span class="fl">2.669</span>,
  <span class="fl">7</span>, <span class="fl">4.642</span>, <span class="fl">41</span>, <span class="fl">2.932</span>, <span class="fl">75</span>, <span class="fl">2.748</span>, <span class="fl">109</span>, <span class="fl">2.667</span>,
  <span class="fl">8</span>, <span class="fl">4.354</span>, <span class="fl">42</span>, <span class="fl">2.923</span>, <span class="fl">76</span>, <span class="fl">2.745</span>, <span class="fl">110</span>, <span class="fl">2.665</span>,
  <span class="fl">9</span>, <span class="fl">4.143</span>, <span class="fl">43</span>, <span class="fl">2.914</span>, <span class="fl">77</span>, <span class="fl">2.742</span>, <span class="fl">111</span>, <span class="fl">2.663</span>,
  <span class="fl">10</span>, <span class="fl">3.981</span>, <span class="fl">44</span>, <span class="fl">2.906</span>, <span class="fl">78</span>, <span class="fl">2.739</span>, <span class="fl">112</span>, <span class="fl">2.662</span>,
  <span class="fl">11</span>, <span class="fl">3.852</span>, <span class="fl">45</span>, <span class="fl">2.898</span>, <span class="fl">79</span>, <span class="fl">2.736</span>, <span class="fl">113</span>, <span class="fl">2.660</span>,
  <span class="fl">12</span>, <span class="fl">3.747</span>, <span class="fl">46</span>, <span class="fl">2.890</span>, <span class="fl">80</span>, <span class="fl">2.733</span>, <span class="fl">114</span>, <span class="fl">2.658</span>,
  <span class="fl">13</span>, <span class="fl">3.659</span>, <span class="fl">47</span>, <span class="fl">2.883</span>, <span class="fl">81</span>, <span class="fl">2.730</span>, <span class="fl">115</span>, <span class="fl">2.657</span>,
  <span class="fl">14</span>, <span class="fl">3.585</span>, <span class="fl">48</span>, <span class="fl">2.876</span>, <span class="fl">82</span>, <span class="fl">2.727</span>, <span class="fl">116</span>, <span class="fl">2.655</span>,
  <span class="fl">15</span>, <span class="fl">3.520</span>, <span class="fl">49</span>, <span class="fl">2.869</span>, <span class="fl">83</span>, <span class="fl">2.724</span>, <span class="fl">117</span>, <span class="fl">2.654</span>,
  <span class="fl">16</span>, <span class="fl">3.464</span>, <span class="fl">50</span>, <span class="fl">2.862</span>, <span class="fl">84</span>, <span class="fl">2.721</span>, <span class="fl">118</span>, <span class="fl">2.652</span>,
  <span class="fl">17</span>, <span class="fl">3.414</span>, <span class="fl">51</span>, <span class="fl">2.856</span>, <span class="fl">85</span>, <span class="fl">2.719</span>, <span class="fl">119</span>, <span class="fl">2.651</span>,
  <span class="fl">18</span>, <span class="fl">3.370</span>, <span class="fl">52</span>, <span class="fl">2.850</span>, <span class="fl">86</span>, <span class="fl">2.716</span>, <span class="fl">120</span>, <span class="fl">2.649</span>,
  <span class="fl">19</span>, <span class="fl">3.331</span>, <span class="fl">53</span>, <span class="fl">2.844</span>, <span class="fl">87</span>, <span class="fl">2.714</span>, <span class="fl">121</span>, <span class="fl">2.648</span>,
  <span class="fl">20</span>, <span class="fl">3.295</span>, <span class="fl">54</span>, <span class="fl">2.838</span>, <span class="fl">88</span>, <span class="fl">2.711</span>, <span class="fl">122</span>, <span class="fl">2.646</span>,
  <span class="fl">21</span>, <span class="fl">3.263</span>, <span class="fl">55</span>, <span class="fl">2.833</span>, <span class="fl">89</span>, <span class="fl">2.709</span>, <span class="fl">123</span>, <span class="fl">2.645</span>,
  <span class="fl">22</span>, <span class="fl">3.233</span>, <span class="fl">56</span>, <span class="fl">2.827</span>, <span class="fl">90</span>, <span class="fl">2.706</span>, <span class="fl">124</span>, <span class="fl">2.643</span>,
  <span class="fl">23</span>, <span class="fl">3.206</span>, <span class="fl">57</span>, <span class="fl">2.822</span>, <span class="fl">91</span>, <span class="fl">2.704</span>, <span class="fl">125</span>, <span class="fl">2.642</span>,
  <span class="fl">24</span>, <span class="fl">3.181</span>, <span class="fl">58</span>, <span class="fl">2.817</span>, <span class="fl">92</span>, <span class="fl">2.701</span>, <span class="fl">126</span>, <span class="fl">2.640</span>,
  <span class="fl">25</span>, <span class="fl">3.158</span>, <span class="fl">59</span>, <span class="fl">2.812</span>, <span class="fl">93</span>, <span class="fl">2.699</span>, <span class="fl">127</span>, <span class="fl">2.639</span>,
  <span class="fl">26</span>, <span class="fl">3.136</span>, <span class="fl">60</span>, <span class="fl">2.807</span>, <span class="fl">94</span>, <span class="fl">2.697</span>, <span class="fl">128</span>, <span class="fl">2.638</span>,
  <span class="fl">27</span>, <span class="fl">3.116</span>, <span class="fl">61</span>, <span class="fl">2.802</span>, <span class="fl">95</span>, <span class="fl">2.695</span>, <span class="fl">129</span>, <span class="fl">2.636</span>,
  <span class="fl">28</span>, <span class="fl">3.098</span>, <span class="fl">62</span>, <span class="fl">2.798</span>, <span class="fl">96</span>, <span class="fl">2.692</span>, <span class="fl">130</span>, <span class="fl">2.635</span>,
  <span class="fl">29</span>, <span class="fl">3.080</span>, <span class="fl">63</span>, <span class="fl">2.793</span>, <span class="fl">97</span>, <span class="fl">2.690</span>, <span class="fl">131</span>, <span class="fl">2.634</span>,
  <span class="fl">30</span>, <span class="fl">3.064</span>, <span class="fl">64</span>, <span class="fl">2.789</span>, <span class="fl">98</span>, <span class="fl">2.688</span>, <span class="fl">132</span>, <span class="fl">2.632</span>,
  <span class="fl">31</span>, <span class="fl">3.048</span>, <span class="fl">65</span>, <span class="fl">2.785</span>, <span class="fl">99</span>, <span class="fl">2.686</span>, <span class="fl">133</span>, <span class="fl">2.631</span>,
  <span class="fl">32</span>, <span class="fl">3.034</span>, <span class="fl">66</span>, <span class="fl">2.781</span>, <span class="fl">100</span>, <span class="fl">2.684</span>, <span class="fl">134</span>, <span class="fl">2.630</span>,
  <span class="fl">33</span>, <span class="fl">3.020</span>, <span class="fl">67</span>, <span class="fl">2.777</span>, <span class="fl">101</span>, <span class="fl">2.682</span>, <span class="fl">135</span>, <span class="fl">2.628</span>,
  <span class="fl">34</span>, <span class="fl">3.007</span>, <span class="fl">68</span>, <span class="fl">2.773</span>, <span class="fl">102</span>, <span class="fl">2.680</span>, <span class="fl">136</span>, <span class="fl">2.627</span>,
  <span class="fl">35</span>, <span class="fl">2.995</span>, <span class="fl">69</span>, <span class="fl">2.769</span>, <span class="fl">103</span>, <span class="fl">2.678</span>, <span class="fl">137</span>, <span class="fl">2.626</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>kA_cmstatr <span class="op">=</span> <span class="fu"><a href="../reference/k_factor_normal.html">k_factor_normal</a></span><span class="op">(</span><span class="va">n</span>, p <span class="op">=</span> <span class="fl">0.99</span>, conf <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">kA_published</span>, <span class="va">kA_cmstatr</span>, tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 136 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n kA_published kA_cmstatr</span>
<span class="co">#&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1     2        37.1       37.1 </span>
<span class="co">#&gt;  2     3        10.6       10.6 </span>
<span class="co">#&gt;  3     4         7.04       7.04</span>
<span class="co">#&gt;  4     5         5.74       5.74</span>
<span class="co">#&gt;  5     6         5.06       5.06</span>
<span class="co">#&gt;  6     7         4.64       4.64</span>
<span class="co">#&gt;  7     8         4.35       4.35</span>
<span class="co">#&gt;  8     9         4.14       4.14</span>
<span class="co">#&gt;  9    10         3.98       3.98</span>
<span class="co">#&gt; 10    11         3.85       3.85</span>
<span class="co">#&gt; # … with 126 more rows</span></code></pre></div>
</div>
<div id="pf-hk" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-hk" class="anchor"></a>7.3 Nonparametric B-Basis Extended Hanson–Koopmans</h2>
<p>Vangel <span class="citation">[5]</span> provides extensive tables of <span class="math inline">\(z\)</span> for the case where <span class="math inline">\(i=1\)</span> and <span class="math inline">\(j\)</span> is the median observation. This section checks the results of <code>cmstatr</code>’s function against those tables. Only the odd values of <span class="math inline">\(n\)</span> are checked so that the median is a single observation. The unit tests for the <code>cmstatr</code> package include checks of a variety of values of <span class="math inline">\(p\)</span> and confidence, but only the factors for B-Basis are checked here.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">z</span>,
  <span class="fl">3</span>,  <span class="fl">28.820048</span>,
  <span class="fl">5</span>,  <span class="fl">6.1981307</span>,
  <span class="fl">7</span>,  <span class="fl">3.4780112</span>,
  <span class="fl">9</span>,  <span class="fl">2.5168762</span>,
  <span class="fl">11</span>, <span class="fl">2.0312134</span>,
  <span class="fl">13</span>, <span class="fl">1.7377374</span>,
  <span class="fl">15</span>, <span class="fl">1.5403989</span>,
  <span class="fl">17</span>, <span class="fl">1.3979806</span>,
  <span class="fl">19</span>, <span class="fl">1.2899172</span>,
  <span class="fl">21</span>, <span class="fl">1.2048089</span>,
  <span class="fl">23</span>, <span class="fl">1.1358259</span>,
  <span class="fl">25</span>, <span class="fl">1.0786237</span>,
  <span class="fl">27</span>, <span class="fl">1.0303046</span>,
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    z_calc <span class="op">=</span> <span class="fu"><a href="../reference/hk_ext.html">hk_ext_z</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.90</span>, conf <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">z_calc</span>, tolerance <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 13 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n     z z_calc</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1     3 28.8   28.8 </span>
<span class="co">#&gt;  2     5  6.20   6.20</span>
<span class="co">#&gt;  3     7  3.48   3.48</span>
<span class="co">#&gt;  4     9  2.52   2.52</span>
<span class="co">#&gt;  5    11  2.03   2.03</span>
<span class="co">#&gt;  6    13  1.74   1.74</span>
<span class="co">#&gt;  7    15  1.54   1.54</span>
<span class="co">#&gt;  8    17  1.40   1.40</span>
<span class="co">#&gt;  9    19  1.29   1.29</span>
<span class="co">#&gt; 10    21  1.20   1.20</span>
<span class="co">#&gt; 11    23  1.14   1.14</span>
<span class="co">#&gt; 12    25  1.08   1.08</span>
<span class="co">#&gt; 13    27  1.03   1.03</span></code></pre></div>
</div>
<div id="pf-hk2" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-hk2" class="anchor"></a>7.4 Nonparametric A-Basis Extended Hanson–Koopmans</h2>
<p>CMH-17-1G provides Table 8.5.15, which contains factors for calculating A-Basis values using the Extended Hanson–Koopmans nonparametric method. That table is reproduced in part here and the factors are compared with those computed by <code>cmstatr</code>. More extensive checks are performed in the unit test of the <code>cmstatr</code> package. The factors computed by <code>cmstatr</code> are very similar to those published in CMH-17-1G.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">k</span>,
  <span class="fl">2</span>, <span class="fl">80.0038</span>,
  <span class="fl">4</span>, <span class="fl">9.49579</span>,
  <span class="fl">6</span>, <span class="fl">5.57681</span>,
  <span class="fl">8</span>, <span class="fl">4.25011</span>,
  <span class="fl">10</span>, <span class="fl">3.57267</span>,
  <span class="fl">12</span>, <span class="fl">3.1554</span>,
  <span class="fl">14</span>, <span class="fl">2.86924</span>,
  <span class="fl">16</span>, <span class="fl">2.65889</span>,
  <span class="fl">18</span>, <span class="fl">2.4966</span>,
  <span class="fl">20</span>, <span class="fl">2.36683</span>,
  <span class="fl">25</span>, <span class="fl">2.131</span>,
  <span class="fl">30</span>, <span class="fl">1.96975</span>,
  <span class="fl">35</span>, <span class="fl">1.85088</span>,
  <span class="fl">40</span>, <span class="fl">1.75868</span>,
  <span class="fl">45</span>, <span class="fl">1.68449</span>,
  <span class="fl">50</span>, <span class="fl">1.62313</span>,
  <span class="fl">60</span>, <span class="fl">1.5267</span>,
  <span class="fl">70</span>, <span class="fl">1.45352</span>,
  <span class="fl">80</span>, <span class="fl">1.39549</span>,
  <span class="fl">90</span>, <span class="fl">1.34796</span>,
  <span class="fl">100</span>, <span class="fl">1.30806</span>,
  <span class="fl">120</span>, <span class="fl">1.24425</span>,
  <span class="fl">140</span>, <span class="fl">1.19491</span>,
  <span class="fl">160</span>, <span class="fl">1.15519</span>,
  <span class="fl">180</span>, <span class="fl">1.12226</span>,
  <span class="fl">200</span>, <span class="fl">1.09434</span>,
  <span class="fl">225</span>, <span class="fl">1.06471</span>,
  <span class="fl">250</span>, <span class="fl">1.03952</span>,
  <span class="fl">275</span>, <span class="fl">1.01773</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>z_calc <span class="op">=</span> <span class="fu"><a href="../reference/hk_ext.html">hk_ext_z</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">n</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/comparison-expectations.html">expect_lt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="va">z_calc</span><span class="op">)</span>, <span class="fl">0.0001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 29 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n     k z_calc</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1     2 80.0   80.0 </span>
<span class="co">#&gt;  2     4  9.50   9.50</span>
<span class="co">#&gt;  3     6  5.58   5.58</span>
<span class="co">#&gt;  4     8  4.25   4.25</span>
<span class="co">#&gt;  5    10  3.57   3.57</span>
<span class="co">#&gt;  6    12  3.16   3.16</span>
<span class="co">#&gt;  7    14  2.87   2.87</span>
<span class="co">#&gt;  8    16  2.66   2.66</span>
<span class="co">#&gt;  9    18  2.50   2.50</span>
<span class="co">#&gt; 10    20  2.37   2.37</span>
<span class="co">#&gt; # … with 19 more rows</span></code></pre></div>
</div>
<div id="pf-hk-opt" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-hk-opt" class="anchor"></a>7.5 Factors for Small Sample Nonparametric B-Basis</h2>
<p>CMH-17-1G Table 8.5.14 provides ranks orders and factors for computing nonparametric B-Basis values. This table is reproduced below and compared with the results of <code>cmstatr</code>. The results are similar. In some cases, the rank order (<span class="math inline">\(r\)</span> in CMH-17-1G or <span class="math inline">\(j\)</span> in <code>cmstatr</code>) <em>and</em> the the factor (<span class="math inline">\(k\)</span>) are different. These differences are discussed in detail in the vignette <a href="hk_ext.html">Extended Hanson-Koopmans</a>.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">r</span>, <span class="op">~</span><span class="va">k</span>,
  <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">35.177</span>,
  <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">7.859</span>,
  <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4.505</span>,
  <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4.101</span>,
  <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">3.064</span>,
  <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">2.858</span>,
  <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">2.382</span>,
  <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">2.253</span>,
  <span class="fl">10</span>, <span class="fl">6</span>, <span class="fl">2.137</span>,
  <span class="fl">11</span>, <span class="fl">7</span>, <span class="fl">1.897</span>,
  <span class="fl">12</span>, <span class="fl">7</span>, <span class="fl">1.814</span>,
  <span class="fl">13</span>, <span class="fl">7</span>, <span class="fl">1.738</span>,
  <span class="fl">14</span>, <span class="fl">8</span>, <span class="fl">1.599</span>,
  <span class="fl">15</span>, <span class="fl">8</span>, <span class="fl">1.540</span>,
  <span class="fl">16</span>, <span class="fl">8</span>, <span class="fl">1.485</span>,
  <span class="fl">17</span>, <span class="fl">8</span>, <span class="fl">1.434</span>,
  <span class="fl">18</span>, <span class="fl">9</span>, <span class="fl">1.354</span>,
  <span class="fl">19</span>, <span class="fl">9</span>, <span class="fl">1.311</span>,
  <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">1.253</span>,
  <span class="fl">21</span>, <span class="fl">10</span>, <span class="fl">1.218</span>,
  <span class="fl">22</span>, <span class="fl">10</span>, <span class="fl">1.184</span>,
  <span class="fl">23</span>, <span class="fl">11</span>, <span class="fl">1.143</span>,
  <span class="fl">24</span>, <span class="fl">11</span>, <span class="fl">1.114</span>,
  <span class="fl">25</span>, <span class="fl">11</span>, <span class="fl">1.087</span>,
  <span class="fl">26</span>, <span class="fl">11</span>, <span class="fl">1.060</span>,
  <span class="fl">27</span>, <span class="fl">11</span>, <span class="fl">1.035</span>,
  <span class="fl">28</span>, <span class="fl">12</span>, <span class="fl">1.010</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>r_calc <span class="op">=</span> <span class="fu"><a href="../reference/hk_ext.html">hk_ext_z_j_opt</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">$</span><span class="va">j</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>k_calc <span class="op">=</span> <span class="fu"><a href="../reference/hk_ext.html">hk_ext_z_j_opt</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 27 × 5</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n     r     k r_calc k_calc</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1     2     2 35.2       2  35.2 </span>
<span class="co">#&gt;  2     3     3  7.86      3   7.86</span>
<span class="co">#&gt;  3     4     4  4.50      4   4.51</span>
<span class="co">#&gt;  4     5     4  4.10      4   4.10</span>
<span class="co">#&gt;  5     6     5  3.06      5   3.06</span>
<span class="co">#&gt;  6     7     5  2.86      5   2.86</span>
<span class="co">#&gt;  7     8     6  2.38      6   2.38</span>
<span class="co">#&gt;  8     9     6  2.25      6   2.25</span>
<span class="co">#&gt;  9    10     6  2.14      6   2.14</span>
<span class="co">#&gt; 10    11     7  1.90      7   1.90</span>
<span class="co">#&gt; # … with 17 more rows</span></code></pre></div>
</div>
<div id="pf-npbinom" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-npbinom" class="anchor"></a>7.6 Nonparametric B-Basis Binomial Rank</h2>
<p>CMH-17-1G Table 8.5.12 provides factors for computing B-Basis values using the nonparametric binomial rank method. Part of that table is reproduced below and compared with the results of <code>cmstatr</code>. The results of <code>cmstatr</code> are similar to the published values. A more complete comparison is performed in the units tests of the <code>cmstatr</code> package.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">rb</span>,
  <span class="fl">29</span>, <span class="fl">1</span>,
  <span class="fl">46</span>, <span class="fl">2</span>,
  <span class="fl">61</span>, <span class="fl">3</span>,
  <span class="fl">76</span>, <span class="fl">4</span>,
  <span class="fl">89</span>, <span class="fl">5</span>,
  <span class="fl">103</span>, <span class="fl">6</span>,
  <span class="fl">116</span>, <span class="fl">7</span>,
  <span class="fl">129</span>, <span class="fl">8</span>,
  <span class="fl">142</span>, <span class="fl">9</span>,
  <span class="fl">154</span>, <span class="fl">10</span>,
  <span class="fl">167</span>, <span class="fl">11</span>,
  <span class="fl">179</span>, <span class="fl">12</span>,
  <span class="fl">191</span>, <span class="fl">13</span>,
  <span class="fl">203</span>, <span class="fl">14</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>r_calc <span class="op">=</span> <span class="fu"><a href="../reference/nonpara_binomial_rank.html">nonpara_binomial_rank</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">rb</span>, <span class="va">r_calc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 14 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;        n    rb r_calc</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1    29     1      1</span>
<span class="co">#&gt;  2    46     2      2</span>
<span class="co">#&gt;  3    61     3      3</span>
<span class="co">#&gt;  4    76     4      4</span>
<span class="co">#&gt;  5    89     5      5</span>
<span class="co">#&gt;  6   103     6      6</span>
<span class="co">#&gt;  7   116     7      7</span>
<span class="co">#&gt;  8   129     8      8</span>
<span class="co">#&gt;  9   142     9      9</span>
<span class="co">#&gt; 10   154    10     10</span>
<span class="co">#&gt; 11   167    11     11</span>
<span class="co">#&gt; 12   179    12     12</span>
<span class="co">#&gt; 13   191    13     13</span>
<span class="co">#&gt; 14   203    14     14</span></code></pre></div>
</div>
<div id="pf-npbinom2" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-npbinom2" class="anchor"></a>7.7 Nonparametric A-Basis Binomial Rank</h2>
<p>CMH-17-1G Table 8.5.13 provides factors for computing B-Basis values using the nonparametric binomial rank method. Part of that table is reproduced below and compared with the results of <code>cmstatr</code>. The results of <code>cmstatr</code> are similar to the published values. A more complete comparison is performed in the units tests of the <code>cmstatr</code> package.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">n</span>, <span class="op">~</span><span class="va">ra</span>,
  <span class="fl">299</span>, <span class="fl">1</span>,
  <span class="fl">473</span>, <span class="fl">2</span>,
  <span class="fl">628</span>, <span class="fl">3</span>,
  <span class="fl">773</span>, <span class="fl">4</span>,
  <span class="fl">913</span>, <span class="fl">5</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>r_calc <span class="op">=</span> <span class="fu"><a href="../reference/nonpara_binomial_rank.html">nonpara_binomial_rank</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">ra</span>, <span class="va">r_calc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 × 3</span>
<span class="co">#&gt; # Rowwise: </span>
<span class="co">#&gt;       n    ra r_calc</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1   299     1      1</span>
<span class="co">#&gt; 2   473     2      2</span>
<span class="co">#&gt; 3   628     3      3</span>
<span class="co">#&gt; 4   773     4      4</span>
<span class="co">#&gt; 5   913     5      5</span></code></pre></div>
</div>
<div id="pf-equiv" class="section level2">
<h2 class="hasAnchor">
<a href="#pf-equiv" class="anchor"></a>7.8 Factors for Equivalency</h2>
<p>Vangel’s 2002 paper provides factors for calculating limits for sample mean and sample extremum for various values of <span class="math inline">\(\alpha\)</span> and sample size (<span class="math inline">\(n\)</span>). A subset of those factors are reproduced below and compared with results from <code>cmstatr</code>. The results are very similar for values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(n\)</span> that are common for composite materials.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"k1.vangel.csv"</span>,
                     package <span class="op">=</span> <span class="st">"cmstatr"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">k1</span>, <span class="va">X2</span><span class="op">:</span><span class="va">X10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"k2.vangel.csv"</span>,
                         package <span class="op">=</span> <span class="st">"cmstatr"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">k2</span>, <span class="va">X2</span><span class="op">:</span><span class="va">X10</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span> <span class="op">=</span> <span class="st">"n"</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="st">"alpha"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">==</span> <span class="fl">0.01</span> <span class="op">|</span> <span class="va">alpha</span> <span class="op">==</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">alpha</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>equiv <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">n</span>, <span class="op">~</span><span class="fu"><a href="../reference/k_equiv.html">k_equiv</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>k1_calc <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">equiv</span>, <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">e</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
         k2_calc <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">equiv</span>, <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">e</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">equiv</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">k1_calc</span>, <span class="va">k2_calc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>check <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">k1_calc</span>, tolerance <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">check</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>check <span class="op">=</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html">expect_equal</a></span><span class="op">(</span><span class="va">k2</span>, <span class="va">k2_calc</span>, tolerance <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">check</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 12 × 6</span>
<span class="co">#&gt; # Groups:   alpha, n [12]</span>
<span class="co">#&gt;    alpha     n    k1    k2 k1_calc k2_calc</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1  0.05     5  2.53 0.852    2.53   0.853</span>
<span class="co">#&gt;  2  0.01     5  3.07 1.14     3.07   1.14 </span>
<span class="co">#&gt;  3  0.05     6  2.60 0.781    2.60   0.781</span>
<span class="co">#&gt;  4  0.01     6  3.13 1.04     3.13   1.04 </span>
<span class="co">#&gt;  5  0.05     7  2.65 0.725    2.65   0.725</span>
<span class="co">#&gt;  6  0.01     7  3.18 0.968    3.18   0.968</span>
<span class="co">#&gt;  7  0.05     8  2.7  0.679    2.70   0.679</span>
<span class="co">#&gt;  8  0.01     8  3.22 0.906    3.22   0.906</span>
<span class="co">#&gt;  9  0.05     9  2.74 0.641    2.74   0.641</span>
<span class="co">#&gt; 10  0.01     9  3.25 0.854    3.25   0.855</span>
<span class="co">#&gt; 11  0.05    10  2.78 0.609    2.78   0.609</span>
<span class="co">#&gt; 12  0.01    10  3.28 0.811    3.28   0.811</span></code></pre></div>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>8. Session Info</h1>
<p>This copy of this vignette was build on the following system.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.1 (2021-08-10)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] testthat_3.0.4 tidyr_1.1.4    purrr_0.3.4    dplyr_1.0.7    cmstatr_0.9.1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] compiler_4.1.1    pillar_1.6.3      tools_4.1.1       kSamples_1.2-9   </span>
<span class="co">#&gt;  [5] pkgload_1.2.2     digest_0.6.28     evaluate_0.14     memoise_2.0.0    </span>
<span class="co">#&gt;  [9] lifecycle_1.0.1   tibble_3.1.5      gtable_0.3.0      pkgconfig_2.0.3  </span>
<span class="co">#&gt; [13] rlang_0.4.11      cli_3.0.1         yaml_2.2.1        pkgdown_1.6.1    </span>
<span class="co">#&gt; [17] xfun_0.26         fastmap_1.1.0     withr_2.4.2       stringr_1.4.0    </span>
<span class="co">#&gt; [21] knitr_1.36        SuppDists_1.1-9.5 generics_0.1.0    desc_1.4.0       </span>
<span class="co">#&gt; [25] fs_1.5.0          vctrs_0.3.8       systemfonts_1.0.2 rprojroot_2.0.2  </span>
<span class="co">#&gt; [29] grid_4.1.1        tidyselect_1.1.1  glue_1.4.2        R6_2.5.1         </span>
<span class="co">#&gt; [33] textshaping_0.3.5 fansi_0.5.0       rmarkdown_2.11    waldo_0.3.1      </span>
<span class="co">#&gt; [37] ggplot2_3.3.5     magrittr_2.0.1    scales_1.1.1      htmltools_0.5.2  </span>
<span class="co">#&gt; [41] ellipsis_0.3.2    MASS_7.3-54       colorspace_2.0-2  ragg_1.1.3       </span>
<span class="co">#&gt; [45] utf8_1.2.2        stringi_1.7.4     munsell_0.5.0     cachem_1.0.6     </span>
<span class="co">#&gt; [49] crayon_1.4.1</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>9. References</h1>
<div id="refs" class="references">
<div id="ref-ASAP2008">
<p>[1] K. S. Raju and J. S. Tomblin, “AGATE Statistical Analysis Program,” Wichita State University, ASAP-2008, 2008.</p>
</div>
<div id="ref-CMH-17-1G">
<p>[2] “Composite Materials Handbook, Volume 1. Polymer Matrix Composites Guideline for Characterization of Structural Materials,” SAE International, CMH-17-1G, Mar. 2012.</p>
</div>
<div id="ref-STAT-17">
<p>[3] Materials Sciences Corporation, “CMH-17 Statistical Analysis for B-Basis and A-Basis Values,” Materials Sciences Corporation, Horsham, PA, STAT-17 Rev 5, Jan. 2008.</p>
</div>
<div id="ref-Stephens1987">
<p>[4] F. W. Scholz and M. Stephens, “K-Sample Anderson-Darling Tests,” <em>Journal of the American Statistical Association</em>, vol. 82, no. 399. pp. 918–924, Sep-1987.</p>
</div>
<div id="ref-Vangel1994">
<p>[5] M. Vangel, “One-Sided Nonparametric Tolerance Limits,” <em>Communications in Statistics - Simulation and Computation</em>, vol. 23, no. 4. pp. 1137–1154, 1994.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.kloppenborg.ca">Stefan Kloppenborg</a>, Comtek Advanced Structures, Ltd..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
