<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate basis values — basis • cmstatr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate basis values — basis"><meta property="og:description" content="Calculate the basis value for a given data set. There are various functions
to calculate the basis values for different distributions.
The basis value is the lower one-sided tolerance bound of a certain
proportion of the population. For more information on tolerance bounds,
see Meeker, et. al. (2017).
For B-Basis, set the content of tolerance bound to \(p=0.90\) and
the confidence level to \(conf=0.95\); for A-Basis, set \(p=0.99\) and
\(conf=0.95\). While other tolerance bound
contents and confidence levels may be computed, they are infrequently
needed in practice.
These functions also perform some automated diagnostic
tests of the data prior to calculating the basis values. These diagnostic
tests can be overridden if needed."><meta property="og:image" content="https://www.cmstatr.net/reference/figures/logo-240x278.png"><meta property="og:image:alt" content="Statistical methods for composite material data: cmstatr"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmstatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adktest.html">Anderson-Darling k-Sample Test</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Graphing.html">Plotting Composite Material Data</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Tutorial.html">cmstatr Tutorial</a>
    </li>
    <li>
      <a href="../articles/cmstatr_Validation.html">cmstatr Validation</a>
    </li>
    <li>
      <a href="../articles/hk_ext.html">Extended Hanson-Koopmans</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cmstatr/cmstatr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate basis values</h1>
    <small class="dont-index">Source: <a href="https://github.com/cmstatr/cmstatr/blob/0.10.0/R/basis.R" class="external-link"><code>R/basis.R</code></a></small>
    <div class="hidden name"><code>basis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the basis value for a given data set. There are various functions
to calculate the basis values for different distributions.
The basis value is the lower one-sided tolerance bound of a certain
proportion of the population. For more information on tolerance bounds,
see Meeker, et. al. (2017).
For B-Basis, set the content of tolerance bound to \(p=0.90\) and
the confidence level to \(conf=0.95\); for A-Basis, set \(p=0.99\) and
\(conf=0.95\). While other tolerance bound
contents and confidence levels may be computed, they are infrequently
needed in practice.</p>
<p>These functions also perform some automated diagnostic
tests of the data prior to calculating the basis values. These diagnostic
tests can be overridden if needed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">basis_normal</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_lognormal</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_weibull</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_pooled_cv</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">groups</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  modcv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_pooled_sd</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">groups</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  modcv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_hk_ext</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"optimum-order"</span>, <span class="st">"woodward-frawley"</span><span class="op">)</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_nonpara_large_sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">basis_anova</span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">x</span>, <span class="va">groups</span>, p <span class="op">=</span> <span class="fl">0.9</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data.frame</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>the variable in the data.frame for which to find the basis value</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>the variable in the data.frame that contains the batches.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>the content of the tolerance bound. Should be 0.90 for B-Basis
and 0.99 for A-Basis</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>confidence level Should be 0.95 for both A- and B-Basis</p></dd>


<dt id="arg-override">override<a class="anchor" aria-label="anchor" href="#arg-override"></a></dt>
<dd><p>a list of names of diagnostic tests to override,
if desired. Specifying "all" will override all diagnostic
tests applicable to the current method.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>the variable in the data.frame representing the groups</p></dd>


<dt id="arg-modcv">modcv<a class="anchor" aria-label="anchor" href="#arg-modcv"></a></dt>
<dd><p>a logical value indicating whether the modified CV approach
should be used. Only applicable to pooling methods.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method for Hanson–Koopmans nonparametric basis values.
should be "optimum-order" for B-Basis and "woodward-frawley"
for A-Basis.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an object of class <code>basis</code>
This object has the following fields:</p><ul><li><p><code>call</code> the expression used to call this function</p></li>
<li><p><code>distribution</code> the distribution used (normal, etc.)</p></li>
<li><p><code>p</code> the value of \(p\) supplied</p></li>
<li><p><code>conf</code> the value of \(conf\) supplied</p></li>
<li><p><code>modcv</code> a logical value indicating whether the modified
CV approach was used. Only applicable to pooling methods.</p></li>
<li><p><code>data</code> a copy of the data used in the calculation</p></li>
<li><p><code>groups</code> a copy of the groups variable.
Only used for pooling and ANOVA methods.</p></li>
<li><p><code>batch</code> a copy of the batch data used for diagnostic tests</p></li>
<li><p><code>modcv_transformed_data</code> the data after the modified CV transformation</p></li>
<li><p><code>override</code> a vector of the names of diagnostic tests that
were overridden. <code>NULL</code> if none were overridden</p></li>
<li><p><code>diagnostic_results</code> a named character vector containing the
results of all the diagnostic tests. See the Details section for
additional information</p></li>
<li><p><code>diagnostic_obj</code> a named list containing the objects produced by the
diagnostic tests.</p></li>
<li><p><code>diagnostic_failures</code> a vector containing any diagnostic tests
that produced failures</p></li>
<li><p><code>n</code> the number of observations</p></li>
<li><p><code>r</code> the number of groups, if a pooling method was used.
Otherwise it is NULL.</p></li>
<li><p><code>basis</code> the basis value computed. This is a number
except when pooling methods are used, in which case it is a data.frame.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>data</code> is an optional argument. If <code>data</code> is given, it should
be a
<code>data.frame</code> (or similar object). When <code>data</code> is specified, the
value of <code>x</code> is expected to be a variable within <code>data</code>. If
<code>data</code> is not specified, <code>x</code> must be a vector.</p>
<p>When <code>modcv=TRUE</code> is set, which is only applicable to the
pooling methods,
the data is first modified according to the modified coefficient
of variation (CV)
rules. This modified data is then used when both calculating the
basis values and
also when performing the diagnostic tests. The modified CV approach
is a way of
adding extra variance to datasets with unexpectedly low variance.</p>
<p><code>basis_normal</code> calculate the basis value by subtracting \(k\) times
the standard deviation from the mean. \(k\) is given by
the function <code><a href="k_factor_normal.html">k_factor_normal()</a></code>. The equations in
Krishnamoorthy and Mathew (2008) are used.
<code>basis_normal</code> also
performs a diagnostic test for outliers (using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for normality (using
<code><a href="anderson_darling.html">anderson_darling_normal()</a></code>).
If the argument <code>batch</code> is given, this function also performs
a diagnostic test for outliers within
each batch (using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for between batch variability (using
<code><a href="ad_ksample.html">ad_ksample()</a></code>). The argument <code>batch</code> is only used
for these diagnostic tests.</p>
<p><code>basis_lognormal</code> calculates the basis value in the same way
that <code>basis_normal</code> does, except that the natural logarithm of the
data is taken.</p>
<p><code>basis_lognormal</code> function also performs
a diagnostic test for outliers (using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for normality (using
<code><a href="anderson_darling.html">anderson_darling_lognormal()</a></code>).
If the argument <code>batch</code> is given, this function also performs
a diagnostic test for outliers within
each batch (using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for between batch variability (using
<code><a href="ad_ksample.html">ad_ksample()</a></code>). The argument <code>batch</code> is only used
for these diagnostic tests.</p>
<p><code>basis_weibull</code> calculates the basis value for data distributed
according to a Weibull distribution. The confidence level for the
content requested is calculated using the conditional method, as
described in Lawless (1982) Section 4.1.2b. This has good agreement
with tables published in CMH-17-1G. Results differ between this function
and STAT17 by approximately 0.5\<!-- %. --></p>
<p><code>basis_weibull</code> function also performs
a diagnostic test for outliers (using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for normality (using
<code><a href="anderson_darling.html">anderson_darling_weibull()</a></code>).
If the argument <code>batch</code> is given, this function also performs
a diagnostic test for outliers within
each batch (using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for between batch variability (using
<code><a href="ad_ksample.html">ad_ksample()</a></code>). The argument <code>batch</code> is only used
for these diagnostic tests.</p>
<p><code>basis_hk_ext</code> calculates the basis value using the Extended
Hanson–Koopmans method, as described in CMH-17-1G and Vangel (1994).
For nonparametric distributions, this function should be used for samples
up to n=28 for B-Basis and up to \(n=299\) for A-Basis.
This method uses a pair of order statistics to determine the basis value.
CMH-17-1G suggests that for A-Basis, the first and last order statistic
is used: this is called the "woodward-frawley" method in this package,
after the paper in which this approach is described (as referenced
by Vangel (1994)). For B-Basis, another approach is used whereby the
first and <code>j-th</code> order statistic are used to calculate the basis value.
In this approach, the <code>j-th</code> order statistic is selected to minimize
the difference between the tolerance limit (assuming that the order
statistics are equal to the expected values from a standard normal
distribution) and the population quantile for a standard normal
distribution. This approach is described in Vangel (1994). This second
method (for use when calculating B-Basis values) is called
"optimum-order" in this package.
The results of <code>basis_hk_ext</code> have been
verified against example results from the program STAT-17. Agreement is
typically well within 0.2%.</p>
<p>Note that the implementation of <code>hk_ext_z_j_opt</code> changed after <code>cmstatr</code>
version 0.8.0. This function is used internally by <code>basis_hk_ext</code>
when <code>method = "optimum-order"</code>. This implementation change may mean
that basis values computed using this method may change slightly
after version 0.8.0. However, both implementations seem to be equally
valid. See the included vignette
for a discussion of the differences between the implementation before
and after version 0.8.0, as well as the factors given in CMH-17-1G.
To access this vignette, run: <code><a href="../articles/hk_ext.html">vignette("hk_ext", package = "cmstatr")</a></code></p>
<p><code>basis_hk_ext</code> also performs
a diagnostic test for outliers (using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and performs a pair of tests that the sample size and method selected
follow the guidance described above.
If the argument <code>batch</code> is given, this function also performs
a diagnostic test for outliers within
each batch (using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for between batch variability (using
<code><a href="ad_ksample.html">ad_ksample()</a></code>). The argument <code>batch</code> is only used
for these diagnostic tests.</p>
<p><code>basis_nonpara_large_sample</code> calculates the basis value
using the large sample method described in CMH-17-1G. This method uses
a sum of binomials to determine the rank of the ordered statistic
corresponding with the desired tolerance limit (basis value). Results
of this function have been verified against results of the STAT-17
program.</p>
<p><code>basis_nonpara_large_sample</code> also performs
a diagnostic test for outliers (using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and performs a test that the sample size is sufficiently large.
If the argument <code>batch</code> is given, this function also performs
a diagnostic test for outliers within
each batch (using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>)
and a diagnostic test for between batch variability (using
<code><a href="ad_ksample.html">ad_ksample()</a></code>). The argument <code>batch</code> is only used
for these diagnostic tests.</p>
<p><code>basis_anova</code> calculates basis values using the ANOVA method.
<code>x</code> specifies the data (normally strength) and <code>groups</code>
indicates the group corresponding to each observation. This method is
described in CMH-17-1G, but when the ratio of between-batch mean
square to the within-batch mean square is less than or equal
to one, the tolerance factor is calculated based on pooling the data
from all groups. This approach is recommended by Vangel (1992)
and by Krishnamoorthy and Mathew (2008), and is also implemented
by the software CMH17-STATS and STAT-17.
This function automatically performs a diagnostic
test for outliers within each group
(using <code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>) and a test for between
group variability (using <code><a href="ad_ksample.html">ad_ksample()</a></code>) as well as checking
that the data contains at least 5 groups.
This function has been verified against the results of the STAT-17 program.</p>
<p><code>basis_pooled_sd</code> calculates basis values by pooling the data from
several groups together. <code>x</code> specifies the data (normally strength)
and <code>group</code> indicates the group corresponding to each observation.
This method is described in CMH-17-1G and matches the pooling method
implemented in ASAP 2008.</p>
<p><code>basis_pooled_cv</code> calculates basis values by pooling the data from
several groups together. <code>x</code> specifies the data (normally strength)
and <code>group</code> indicates the group corresponding to each observation.
This method is described in CMH-17-1G.</p>
<p><code>basis_pooled_sd</code> and <code>basis_pooled_cv</code> both automatically
perform a number of diagnostic tests. Using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>, they check that there are no
outliers within each group and batch (provided that <code>batch</code> is
specified). They check the between batch variability using
<code><a href="ad_ksample.html">ad_ksample()</a></code>. They check that there are no outliers within
each group (pooling all batches) using
<code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code>. They check for the normality
of the pooled data using <code><a href="anderson_darling.html">anderson_darling_normal()</a></code>.
<code>basis_pooled_sd</code> checks for equality of variance of all
data using <code><a href="levene_test.html">levene_test()</a></code> and <code>basis_pooled_cv</code>
checks for equality of variances of all data after transforming it
using <code><a href="normalize_group_mean.html">normalize_group_mean()</a></code>
using <code><a href="levene_test.html">levene_test()</a></code>.</p>
<p>The object returned by these functions includes the named vector
<code>diagnostic_results</code>. This contains all of the diagnostic tests
performed. The name of each element of the vector corresponds with the
name of the diagnostic test. The contents of each element will be
"P" if the diagnostic test passed, "F" if the diagnostic test failed,
"O" if the diagnostic test was overridden and <code>NA</code> if the
diagnostic test was skipped (typically because an optional
argument was not supplied).</p>
<p>The objects produced by the diagnostic tests are included in the named
list <code>diagnostic_obj</code>. The name of each element in the list corresponds with
the name of the test. This can be useful when evaluating diagnostic test
failures.</p>
<p>The following list summarizes the diagnostic tests automatically
performed by each function.</p><ul><li><p><code>basis_normal</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_batch_variability</code></p></li>
<li><p><code>outliers</code></p></li>
<li><p><code>anderson_darling_normal</code></p></li>
</ul></li>
<li><p><code>basis_lognormal</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_batch_variability</code></p></li>
<li><p><code>outliers</code></p></li>
<li><p><code>anderson_darling_lognormal</code></p></li>
</ul></li>
<li><p><code>basis_weibull</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_batch_variability</code></p></li>
<li><p><code>outliers</code></p></li>
<li><p><code>anderson_darling_weibull</code></p></li>
</ul></li>
<li><p><code>basis_pooled_cv</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_group_variability</code></p></li>
<li><p><code>outliers_within_group</code></p></li>
<li><p><code>pooled_data_normal</code></p></li>
<li><p><code>normalized_variance_equal</code></p></li>
</ul></li>
<li><p><code>basis_pooled_sd</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_group_variability</code></p></li>
<li><p><code>outliers_within_group</code></p></li>
<li><p><code>pooled_data_normal</code></p></li>
<li><p><code>pooled_variance_equal</code></p></li>
</ul></li>
<li><p><code>basis_hk_ext</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_batch_variability</code></p></li>
<li><p><code>outliers</code></p></li>
<li><p><code>sample_size</code></p></li>
</ul></li>
<li><p><code>basis_nonpara_large_sample</code></p><ul><li><p><code>outliers_within_batch</code></p></li>
<li><p><code>between_batch_variability</code></p></li>
<li><p><code>outliers</code></p></li>
<li><p><code>sample_size</code></p></li>
</ul></li>
<li><p><code>basis_anova</code></p><ul><li><p><code>outliers_within_group</code></p></li>
<li><p><code>equality_of_variance</code></p></li>
<li><p><code>number_of_groups</code></p></li>
</ul></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>J. F. Lawless, Statistical Models and Methods for Lifetime Data.
New York: John Wiley &amp; Sons, 1982.</p>
<p>“Composite Materials Handbook, Volume 1. Polymer Matrix Composites
Guideline for Characterization of Structural Materials,” SAE International,
CMH-17-1G, Mar. 2012.</p>
<p>M. Vangel, “One-Sided Nonparametric Tolerance Limits,”
Communications in Statistics - Simulation and Computation,
vol. 23, no. 4. pp. 1137–1154, 1994.</p>
<p>K. Krishnamoorthy and T. Mathew, Statistical Tolerance Regions: Theory,
Applications, and Computation. Hoboken: John Wiley &amp; Sons, 2008.</p>
<p>W. Meeker, G. Hahn, and L. Escobar, Statistical Intervals: A Guide
for Practitioners and Researchers, Second Edition.
Hoboken: John Wiley &amp; Sons, 2017.</p>
<p>M. Vangel, “New Methods for One-Sided Tolerance Limits for a One-Way
Balanced Random-Effects ANOVA Model,” Technometrics, vol. 34, no. 2.
Taylor &amp; Francis, pp. 176–185, 1992.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hk_ext.html">hk_ext_z_j_opt()</a></code></p>
<p><code><a href="k_factor_normal.html">k_factor_normal()</a></code></p>
<p><code><a href="transform_mod_cv.html">transform_mod_cv()</a></code></p>
<p><code><a href="maximum_normed_residual.html">maximum_normed_residual()</a></code></p>
<p><code><a href="anderson_darling.html">anderson_darling_normal()</a></code></p>
<p><code><a href="anderson_darling.html">anderson_darling_lognormal()</a></code></p>
<p><code><a href="anderson_darling.html">anderson_darling_weibull()</a></code></p>
<p><code><a href="ad_ksample.html">ad_ksample()</a></code></p>
<p><code><a href="normalize_group_mean.html">normalize_group_mean()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A single-point basis value can be calculated as follows</span></span></span>
<span class="r-in"><span><span class="co"># in this example, three failed diagnostic tests are</span></span></span>
<span class="r-in"><span><span class="co"># overridden.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">carbon.fabric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">test</span> <span class="op">==</span> <span class="st">"FC"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"RTD"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">basis_normal</span><span class="op">(</span><span class="va">strength</span>, <span class="va">batch</span>,</span></span>
<span class="r-in"><span>               override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outliers"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"outliers_within_batch"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"anderson_darling_normal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> basis_normal(data = ., x = strength, batch = batch, override = c("outliers", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "outliers_within_batch", "anderson_darling_normal"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution:  Normal 	( n = 18 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The following diagnostic tests were overridden:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     `outliers`,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     `outliers_within_batch`,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     `anderson_darling_normal`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76.94656 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Call:</span></span></span>
<span class="r-in"><span><span class="co">## basis_normal(data = ., x = strength, batch = batch,</span></span></span>
<span class="r-in"><span><span class="co">##     override = c("outliers", "outliers_within_batch",</span></span></span>
<span class="r-in"><span><span class="co">##    "anderson_darling_normal"))</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Distribution:  Normal   ( n = 18 )</span></span></span>
<span class="r-in"><span><span class="co">## The following diagnostic tests were overridden:</span></span></span>
<span class="r-in"><span><span class="co">##     `outliers`,</span></span></span>
<span class="r-in"><span><span class="co">##     `outliers_within_batch`,</span></span></span>
<span class="r-in"><span><span class="co">##     `anderson_darling_normal`</span></span></span>
<span class="r-in"><span><span class="co">## B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span></span>
<span class="r-in"><span><span class="co">## 76.94656</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">diagnostic_obj</span><span class="op">$</span><span class="va">between_batch_variability</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ad_ksample(x = x, groups = batch, alpha = 0.025)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N = 18           k = 3            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ADK = 1.73       p-value = 0.52151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Call:</span></span></span>
<span class="r-in"><span><span class="co">## ad_ksample(x = x, groups = batch, alpha = 0.025)</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## N = 18           k = 3</span></span></span>
<span class="r-in"><span><span class="co">## ADK = 1.73       p-value = 0.52151</span></span></span>
<span class="r-in"><span><span class="co">## Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A set of pooled basis values can also be calculated</span></span></span>
<span class="r-in"><span><span class="co"># using the pooled standard deviation method, as follows.</span></span></span>
<span class="r-in"><span><span class="co"># In this example, one failed diagnostic test is overridden.</span></span></span>
<span class="r-in"><span><span class="va">carbon.fabric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">test</span> <span class="op">==</span> <span class="st">"WT"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">basis_pooled_sd</span><span class="op">(</span><span class="va">strength</span>, <span class="va">condition</span>, <span class="va">batch</span>,</span></span>
<span class="r-in"><span>                  override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outliers_within_batch"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> basis_pooled_sd(data = ., x = strength, groups = condition, batch = batch, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     override = c("outliers_within_batch"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution:  Normal - Pooled Standard Deviation 	( n = 54, r = 3 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The following diagnostic tests were overridden:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     `outliers_within_batch`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-Basis:   ( p = 0.9 , conf = 0.95 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CTD  127.6914 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ETW  125.0698 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RTD  132.1457 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Call:</span></span></span>
<span class="r-in"><span><span class="co">## basis_pooled_sd(data = ., x = strength, groups = condition,</span></span></span>
<span class="r-in"><span><span class="co">##                 batch = batch, override = c("outliers_within_batch"))</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Distribution:  Normal - Pooled Standard Deviation   ( n = 54, r = 3 )</span></span></span>
<span class="r-in"><span><span class="co">## The following diagnostic tests were overridden:</span></span></span>
<span class="r-in"><span><span class="co">##     `outliers_within_batch`</span></span></span>
<span class="r-in"><span><span class="co">## B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span></span>
<span class="r-in"><span><span class="co">## CTD  127.6914</span></span></span>
<span class="r-in"><span><span class="co">## ETW  125.0698</span></span></span>
<span class="r-in"><span><span class="co">## RTD  132.1457</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.kloppenborg.ca" class="external-link">Stefan Kloppenborg</a>, Comtek Advanced Structures, Ltd..</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

